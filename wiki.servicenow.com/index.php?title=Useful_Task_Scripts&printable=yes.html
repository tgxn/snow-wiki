<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8"/>
<title>Useful Task Scripts - ServiceNow Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Useful_Task_Scripts","wgTitle":"Useful Task Scripts","wgCurRevisionId":83717,"wgRevisionId":83717,"wgArticleId":6114,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Useful Scripts","Task Scripts","Incident Management"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Useful_Task_Scripts","wgRelevantArticleId":6114,"wgRequestId":"bbe35169277a35055bfbae72","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":20,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup","ext.voteNY"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=ext.pygments%257Cmediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cmediawiki.skinning.content.externallinks%257Cmediawiki.skinning.interface%257Cskins.monobook.styles&amp;only=styl.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;printable=1&amp;skin=monobook.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.27.3"/>
<meta name="robots" content="noindex,follow"/>
<meta name="robots" content="index,follow,noarchive"/>
<meta name="copyright" content="ServiceNow"/>
<meta http-equiv="content-language" content="en"/>
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<meta name="modified" content="20110707200622"/>
<meta name="canonical" content="//wiki.servicenow.com/index.php?title=Useful_Task_Scripts"/>
<meta name="author" content="ServiceNow"/>
<meta name="twitter:card" content="@NOWsupport"/>
<meta name="twitter:title" content="Useful Task Scripts"/>
<meta name="twitter:creator" content="@NOWsupport"/>
<meta name="twitter:domain" content="servicenow.com"/>
<meta name="keywords" content="Incident Management"/>
<meta name="category" content="Incident Management"/>
<link rel="shortcut icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="ServiceNow Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php%3Faction=rsd"/>
<link rel="alternate" type="application/atom+xml" title="ServiceNow Wiki Atom feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=atom.html"/>
<script type="text/javascript">window.tamBaseUrl='/extensions/TreeAndMenu'</script>

<script type="text/javascript" src="extensions/TreeAndMenu/dtree.js"></script>

<link rel="canonical" href="index.php%3Ftitle=Useful_Task_Scripts.html" />

	<meta property="og:title" content="ServiceNow Wiki:Useful Task Scripts"/>

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ServiceNow Wiki"/>

	<meta property="modified" content="20110707200622"/>

	<meta property="article:published_time" content="20110707200622"/>

	<meta property="article:modified_time" content="20110707200622"/>

	<meta property="article:author" content="ServiceNow"/>

	<meta property="article:tag" content="Incident Management"/>

	<meta property="og:url" content="//wiki.servicenow.com/index.php?title=Useful_Task_Scripts"/>

</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Useful_Task_Scripts rootpage-Useful_Task_Scripts skin-monobook action-view">
<div id="header">
	<div id="snc_top_toolbar" >
	<ul class="inline" id="sites">
		<li><a href="index.html">Wiki home</a></li>
		<li><a href="http://community.servicenow.com">Community</a></li>
		<li><a href="http://www.servicenow.com/services/training-and-certification.html">Training</a></li>
		<li><a href="https://www.servicenow.com/support.html">Support home</a></li>
		<li><a href="http://www.servicenow.com">Company home</a></li>
		<li><a href="http://info.servicenow.com/demonow/">Demo</a></li>
	</ul>

<!-- Start Adobe analytics staging -->
<script src="http://assets.adobedtm.com/43c21e31f00ba1c49c16c9c6a5acf67ef1e8dfa8/satelliteLib-c41330e93f48feef745e6ecb4b425db9d5da2dea.js"></script>

<!--Begin Google analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29210697-1']);
  _gaq.push(['_setDomainName', 'servicenow.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  _gaq.push(['_trackPageLoadTime']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- End Google analytics, begin other analytics -->

<!--<script type="text/javascript" language="javascript">llactid=11051</script>
<script type="text/javascript" language="javascript" src="https://trackalyzer.com/trackalyze_secure.js"></script>
-->
<!--End analytics-->

	</div>
</div>
<div id="snc_toolbar" >
	<a href="index.html">
	<img src="https://wiki.service-now.com/images/CustomWikiLogoFixed.png" height="64px">
	</a>
<div id="googleSearchBox"> <!--Google Search box -->
<div id='cse-search-form' style='width: 100%;'>Loading</div>
<script src='http://www.google.com/jsapi' type='text/javascript'></script>


<script type='text/javascript'>

google.load('search', '1', {language: 'en', style: google.loader.themes.V2_DEFAULT, callback:loadCSE});

window.onhashchange = function() {
	var url = window.location.href;
	if(url.indexOf("gsc.q") == -1) //call only when not browsing search results.
	{
		resetUI();
	}
}

function resetUI() {
	//reset UI to standard layout. Hide search, restore page content/controls.
	var cactions = document.getElementById('p-cactions');
	var cont = document.getElementById('content');
	var sr = document.getElementById('cse');

	cactions.style.display = 'block';
	sr.style.display = 'none';
	cont.style.display = 'block';
};

function onSubmit() {
	//hide page elements when searching.
	var cactions = document.getElementById('p-cactions');
	cactions.style.display = 'none';
	var sr = document.getElementById('cse');
	sr.style.display = 'block';
	var cont = document.getElementById('content');
	cont.style.display = 'none';
};

function loadCSE() {
	var customSearchOptions = {};
	var orderByOptions = {};
	orderByOptions['keys'] = [{label: 'Relevance', key: ''} , {label: 'Date', key: 'date'}];
	customSearchOptions['enableOrderBy'] = true;
	customSearchOptions['orderByOptions'] = orderByOptions;

	var customSearchControl = new google.search.CustomSearchControl('005409823165138974380:bltnnmgfoek', customSearchOptions);
	customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
	customSearchControl.setSearchCompleteCallback(this,onSubmit);//set onSubmit script to run when searching

	var options = new google.search.DrawOptions();
	options.setSearchFormRoot('cse-search-form');
	options.setAutoComplete(true);
	customSearchControl.draw('cse', options);
	var historyStarted = customSearchControl.startHistoryManagement();
	if(historyStarted) customSearchControl.setLinkTarget(google.search.Search.LINK_TARGET_SELF);
};

</script>

</div> <!--end Google search box-->
</div>

<div id="globalWrapper">
		<div id="column-content">
			<div id="cse"></div>
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div class="collection-creatorbox"><img src="extensions/Collection/images/Open_book.png%3F9" alt="" width="80" height="45" class="collection-creatorbox-book" /><div class="collection-creatorbox-row"><div><a href="index.php%3Ftitle=Help:Books.html" title="Show help about creating books" rel="nofollow"><img src="extensions/Collection/images/silk-help.png" alt="" width="16" height="16" />&#160;Help</a></div><span class="collection-creatorbox-title">Book creator</span> (<a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Useful+Task+Scripts.html" title="Stop using the book creator" rel="nofollow">disable</a>)</div><div id="coll-book_creator_box" class="collection-creatorbox-row"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Useful+Task+Scripts&amp;oldid=0.html" title="Add the current wiki page to your book" id="coll-add_article" rel="nofollow" onclick="collectionCall('AddArticle', ['removearticle', wgNamespaceNumber, wgTitle, &quot;0&quot;]); return false;"><img src="extensions/Collection/images/silk-add.png" alt="" width="16" height="16" />&#160;Add this page to your book</a><a href="index.php%3Ftitle=Special:Book%252Fload_collection%252F&amp;colltitle=Book:Introduction_to_ServiceNow_Part_1.html" title="Click to edit/download/order your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-book_open.png" alt="" width="16" height="16" />&#160;Show book (31 pages)</a><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=suggest.html" title="Show suggestions based on the pages in your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-wand.png" alt="" width="16" height="16" style="vertical-align: text-bottom" />&#160;Suggest pages</a></div></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Useful Task Scripts</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From ServiceNow Wiki</div>
					<div id="contentSub"><!-- Text for discussion pages-->
<a href="index.html" title="Main Page">Home</a> &gt; <a href="index.php%3Ftitle=Script_in_ServiceNow.html" title="Script in ServiceNow">Script</a> &gt; <a href="index.php%3Ftitle=Useful_Scripts_Portal.html" title="Useful Scripts Portal">Useful Scripts</a> &gt; Useful Task Scripts</div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php%3Ftitle=Useful_Task_Scripts&amp;printable=yes.html#column-one">navigation</a>, <a href="index.php%3Ftitle=Useful_Task_Scripts&amp;printable=yes.html#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>This is a searchable version of the Useful Task Scripts. For an easy-to-navigate version, visit the <a href="index.php%3Ftitle=Useful_Scripts_portal.html" title="Useful Scripts portal" class="mw-redirect">Useful Scripts portal</a>. 
</p>
<hr />
<p><a href="http://wiki.servicenow.com/index.php?title=Allow_Self-Service_Users_to_View_Other_Incidents&amp;action=edit&amp;redlink=1" class="new" title="Allow Self-Service Users to View Other Incidents (page does not exist)">Allow Self-Service Users to View Other Incidents</a>
</p><p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Auto-Assign to User on Accept 
</p><p><b>Type:</b> Client Script 
</p><p><b>Table:</b> Incident
</p><p><b>Description:</b> This is an onChange Client Script that will set the <b>Assigned To</b> to the person who is changing the incident state to <b>Active</b>. 
</p><p><b>Parameters:</b> Field Name: Incident State
</p>
<b>Script:</b> <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onChange</span><span class="p">(</span><span class="nx">control</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">//If the page isn&#39;t loading</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//If the new value isn&#39;t blank</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">newValue</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">//Type appropriate comment here, and begin script below</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">newValue</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">){</span>
               <span class="kd">var</span> <span class="nx">isItil</span> <span class="o">=</span> <span class="nx">g_user</span><span class="p">.</span><span class="nx">hasRole</span><span class="p">(</span><span class="s1">&#39;itil&#39;</span><span class="p">);</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">isItil</span><span class="p">){</span>
                     <span class="nx">g_form</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s1">&#39;assigned_to&#39;</span><span class="p">,</span> <span class="nx">g_user</span><span class="p">.</span><span class="nx">userID</span><span class="p">);</span>
                  <span class="p">}</span>  
            <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p>name = Change Urgency to High if User is VIP <br />
type = Client Script <br />
table = Incident <br />
param = Field = Caller <br />
description = This is an onChange client script that will check to see if the caller is a VIP (based on the VIP field on the user record), if so change the urgency to high. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onChange</span><span class="p">(</span><span class="nx">control</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">//If the page isn&#39;t loading</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//If the new value isn&#39;t blank</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">newValue</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">//If inc is already urgency of high no need to go on</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;urgency&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">){</span> 
            <span class="kd">var</span> <span class="nx">caller</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getReference</span><span class="p">(</span><span class="s1">&#39;caller_id&#39;</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">caller</span><span class="p">.</span><span class="nx">vip</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">)</span> <span class="p">{</span>
                 <span class="nx">g_form</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s1">&#39;urgency&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>
              <span class="p">}</span>      
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
If you are already using the default client script: Highlight VIP Caller, you can add in the following line to that client script: <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nx">g_form</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s1">&#39;urgency&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>
</pre></div> after this line: <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="k">if</span><span class="p">(</span><span class="nx">caller</span><span class="p">.</span><span class="nx">vip</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">)</span> <span class="p">{</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Close and Cascade Comments to Child Tasks 
</p><p><b>Type:</b> Business Rule 
</p><p><b>Table:</b> Incident
</p><p><b>Description:</b> This example will close and cascade comments to child incidents after the parent has been closed. 
</p><p><b>Parameters:</b> Run: After insert and  update
</p><p><b>Script:</b> 
</p><p>Condition:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nx">current</span><span class="p">.</span><span class="nx">active</span><span class="p">.</span><span class="nx">changesTo</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
</pre></div>
<p>Script:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nx">cascadeComment</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">cascadeComment</span><span class="p">(){</span>

 <span class="kd">var</span> <span class="nx">cmt</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">comments</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">inc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;incident&quot;</span><span class="p">);</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
   <span class="k">while</span> <span class="p">(</span><span class="nx">inc</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
    <span class="nx">inc</span><span class="p">.</span><span class="nx">comments</span> <span class="o">=</span> <span class="nx">cmt</span><span class="p">;</span>
    <span class="nx">inc</span><span class="p">.</span><span class="nx">incident_state</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span> <span class="mi">7</span><span class="p">);</span>
    <span class="nx">inc</span><span class="p">.</span><span class="nx">active</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="nx">inc</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
    <span class="nx">gs</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Incident &quot;</span> <span class="o">+</span> <span class="nx">inc</span><span class="p">.</span><span class="nx">number</span> <span class="o">+</span> <span class="s2">&quot; closed based on closure of incident &quot;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">number</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Close Old Tasks 
</p><p><b>Type:</b> Scheduled Script 
</p><p><b>Table:</b> incident
</p><p><b>Description:</b> This script checks daily and closes any incident over 30 days old. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">oldIncident</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;incident&#39;</span><span class="p">);</span>
<span class="nx">oldIncident</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;opened_at&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">daysAgoStart</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span>
<span class="nx">oldIncident</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;incident_state&#39;</span><span class="p">,</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">);</span>
<span class="nx">oldIncident</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>

<span class="k">while</span> <span class="p">(</span><span class="nx">oldIncident</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">oldIncident</span><span class="p">.</span><span class="nx">incident_state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
  <span class="nx">oldIncident</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Display Task Number as Window Title 
</p><p><b>Type:</b> UI Script 
</p><p><b>Table:</b> 
</p><p><b>Description:</b> This UI Script populates the browser window with the number and short description of the incident being viewed.  UI Script should be marked as global. 
</p><p><b>Parameters:</b> 
</p>
<b>Script:</b> <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">setTitle</span><span class="p">(){</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">num</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sd</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s2">&quot;short_description&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// alert(&#39;Error getting title info.&#39;);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">num</span> <span class="o">&amp;&amp;</span> <span class="nx">sd</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">top</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">num</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nx">sd</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">top</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="o">=</span><span class="s1">&#39;ServiceNow - IT Service Management Suite&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">addLoadEvent</span><span class="p">(</span><span class="nx">setTitle</span><span class="p">);</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Log Group Activity 
</p><p><b>Type:</b>  
</p><p><b>Table:</b> 
</p><p><b>Description:</b> This script logs all changes made to an incident by a group. In order to use the script, first create a new table (Group Activity) then create a couple reference fields referencing the data you are looking to capture (in this example, Incident and Assignment Group). 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">//Create an log file of the group assignment</span>
   <span class="kd">var</span> <span class="nx">ex</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;group_activity&#39;</span><span class="p">);</span>
   <span class="nx">ex</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
   <span class="nx">ex</span><span class="p">.</span><span class="nx">u_assignment_group</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">assignment_group</span><span class="p">;</span>
   <span class="nx">ex</span><span class="p">.</span><span class="nx">u_incident</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>
   <span class="nx">ex</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Duplicate a Record Along with Related List 
</p><p><b>Type:</b> UI Action 
</p><p><b>Table:</b> 
</p><p><b>Description:</b>  
</p><p><b>Parameters:</b> 
</p>
<b>Script:</b> <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">//clear the fields we dont want to copy</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">start_date</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">end_date</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
 
<span class="c1">//set some new default values</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">u_change_phase</span> <span class="o">=</span> <span class="s1">&#39;Draft&#39;</span><span class="p">;</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">approval</span> <span class="o">=</span> <span class="s1">&#39;not requested&#39;</span><span class="p">;</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//open state</span>
 
<span class="c1">//insert a copy and copy affected CIs</span>
<span class="kd">var</span> <span class="nx">oldid</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">newid</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
 
<span class="k">if</span> <span class="p">(</span><span class="nx">newid</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">taskcis</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;task_ci&#39;</span><span class="p">);</span>
  <span class="nx">taskcis</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span><span class="nx">oldid</span><span class="p">);</span>
  <span class="nx">taskcis</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
  <span class="k">while</span> <span class="p">(</span><span class="nx">taskcis</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
    <span class="nx">taskcis</span><span class="p">.</span><span class="nx">task</span> <span class="o">=</span> <span class="nx">newid</span><span class="p">;</span>
    <span class="nx">taskcis</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
 
<span class="c1">//copy affected companies</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">newid</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">crComp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;u_m2m_companies_change_request&#39;</span><span class="p">);</span>
  <span class="nx">crComp</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;u_change_request&#39;</span><span class="p">,</span><span class="nx">oldid</span><span class="p">);</span>
  <span class="nx">crComp</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
  <span class="k">while</span> <span class="p">(</span><span class="nx">crComp</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
    <span class="nx">crComp</span><span class="p">.</span><span class="nx">u_change_request</span> <span class="o">=</span> <span class="nx">newid</span><span class="p">;</span>
    <span class="nx">crComp</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
 
<span class="c1">//bring the user to the new record</span>
<span class="nx">action</span><span class="p">.</span><span class="nx">setRedirectURL</span><span class="p">(</span><span class="nx">current</span><span class="p">);</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Find Computer Assigned to Caller and Populate CI Field 
</p><p><b>Type:</b> Client Script 
</p><p><b>Table:</b> incident
</p><p><b>Description:</b> This script checks what computer is assigned to the caller, and fills in the information in the affected CI field if the CI field is blank. 
</p><p><b>Parameters:</b> OnChange of Caller ID
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onChange</span><span class="p">(</span><span class="nx">control</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">//If the page isn&#39;t loading</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//If the new value isn&#39;t blank</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">newValue</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">//check to see if we have a CI listed </span>
         <span class="kd">var</span> <span class="nx">ci</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;cmdb_ci&#39;</span><span class="p">);</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">ci</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
	    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;caller_id&#39;</span><span class="p">);</span> <span class="c1">//get the current user</span>
    	    <span class="kd">var</span> <span class="nx">gr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;cmdb_ci_computer&#39;</span><span class="p">);</span> <span class="c1">//Table your computers reside in</span>
            <span class="nx">gr</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;assigned_to&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="p">);</span>
            <span class="nx">gr</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">gr</span><span class="p">.</span><span class="nx">next</span><span class="p">()){</span>
               <span class="nx">g_form</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s1">&#39;cmdb_ci&#39;</span><span class="p">,</span> <span class="nx">gr</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>This script is the same, except it checks other tables if it does not find the computer: 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onChange</span><span class="p">(</span><span class="nx">control</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//If the page isn&#39;t loading</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">//If the new value isn&#39;t blank</span>
       <span class="k">if</span><span class="p">(</span><span class="nx">newValue</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">//check to see if we have a CI listed</span>
         <span class="kd">var</span> <span class="nx">ci</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;cmdb_ci&#39;</span><span class="p">);</span>
         <span class="k">if</span><span class="p">(</span><span class="nx">ci</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
           <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;caller_id&#39;</span><span class="p">);</span>
           <span class="kd">var</span> <span class="nx">gr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;cmdb_rel_person&#39;</span><span class="p">);</span> <span class="c1">//Table your relationship resides in</span>
           <span class="nx">gr</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="p">);</span>
           <span class="nx">gr</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
           <span class="k">if</span><span class="p">(</span><span class="nx">gr</span><span class="p">.</span><span class="nx">next</span><span class="p">()){</span>
              <span class="nx">g_form</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s1">&#39;cmdb_ci&#39;</span><span class="p">,</span> <span class="nx">gr</span><span class="p">.</span><span class="nx">ci</span><span class="p">);</span>
           <span class="p">}</span><span class="k">else</span><span class="p">{</span>
              <span class="kd">var</span> <span class="nx">gr1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;cmdb_ci_computer&#39;</span><span class="p">);</span> <span class="c1">//Table your computers reside in</span>
              <span class="nx">gr1</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;assigned_to&#39;</span><span class="p">,</span> <span class="nx">user</span><span class="p">);</span> <span class="c1">//or used by or whatever field you are using</span>
              <span class="nx">gr1</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
              <span class="k">if</span><span class="p">(</span><span class="nx">gr1</span><span class="p">.</span><span class="nx">next</span><span class="p">()){</span>
                <span class="nx">g_form</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s1">&#39;cmdb_ci&#39;</span><span class="p">,</span> <span class="nx">gr1</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span> 
              <span class="p">}</span>
           <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">}</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Hide Activity Formatter on Form based on Role 
</p><p><b>Type:</b> Client Script 
</p><p><b>Table:</b> Task
</p><p><b>Description:</b> This removes the activity section on task forms for anyone who doesn't have the admin role. 
</p><p><b>Parameters:</b> 
</p>
<b>Script:</b> <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onLoad</span><span class="p">()</span> <span class="p">{</span>
   <span class="c1">//hide the activity section for users that do not have the admin role</span>
  <span class="kd">var</span> <span class="nx">isAdmin</span> <span class="o">=</span> <span class="nx">g_user</span><span class="p">.</span><span class="nx">hasRole</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">);</span> <span class="c1">//Check if user has admin role</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isAdmin</span><span class="p">){</span>
    <span class="c1">//activity section does not have an id</span>
    <span class="c1">//get all of the TD tag elements in the document</span>
    <span class="kd">var</span> <span class="nx">refs</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;TD&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">refs</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">refs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ref</span> <span class="o">=</span> <span class="nx">refs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">inner</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
        <span class="c1">//check for the ID of the activity section label</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inner</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;formatter.incident_activity.xml&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
          <span class="nx">ref</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>  
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><br />
<b>Name:</b> Indicating Updated Tickets 
</p><p><b>Type:</b> Field Styles 
</p><p><b>Table:</b> incident
</p><p><b>Description:</b> The first field style creates a small indicator next to incidents that have been updated since the user's last view of the list. The second field style simply indents the other incident numbers so that they still line up.
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>If this list is viewed in Internet Explorer as a related list on a tabbed form, Internet Explorer will display a warning to the user about viewing unsecured content.</i>
</td></tr></table>
<p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p><p><b>First Field Style</b> 
</p><p><i>Condition Value:</i> 
</p>
<pre>javascript:(current.assigned_to.user_name==gs.getUserName()&amp;&amp;current.assigned_to.user_name&#160;!=current.sys_updated_by)&amp;&amp;current.incident_state &lt; 7</pre> 
<p><i>Style:</i> 
</p>
<pre>background-image: url('images/icons/bullet.gif');
background-repeat: no-repeat;
background-position:2 2;
text-indent: 15px;</pre> 
<p><br /> <b>Second Field Style</b> 
</p><p><i>Condition Value:</i> 
</p>
<pre>javascript:!(current.assigned_to.user_name==gs.getUserName()&amp;&amp;current.assigned_to.user_name&#160;!=current.sys_updated_by)||current.incident_state == 7</pre> 
<p><i>Style:</i> 
</p>
<pre>text-indent: 15px;</pre>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Make Close Note Mandatory 
</p><p><b>Type:</b>  
</p><p><b>Table:</b> incident
</p><p><b>Description:</b> This script makes the Close Notes field on a form mandatory when clicking the submit button to close. 
</p><p><b>Parameters:</b> 
</p>
<b>Script:</b> <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onSubmit</span><span class="p">()</span> <span class="p">{</span>       
  <span class="kd">var</span> <span class="nx">action</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getActionName</span><span class="p">();</span>     
  <span class="kd">var</span> <span class="nx">inc_state</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;incident_state&#39;</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">&#39;close_incident&#39;</span> <span class="o">||</span> <span class="nx">inc_state</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span> <span class="o">||</span> <span class="nx">inc_state</span> <span class="o">==</span> <span class="s1">&#39;7&#39;</span><span class="p">)</span> <span class="p">{</span> 
    <span class="kd">var</span> <span class="nx">close_note</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;close_notes&#39;</span><span class="p">);</span>                  
    <span class="k">if</span> <span class="p">(</span><span class="nx">close_note</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Close Notes are mandatory!&#39;</span><span class="p">);</span>             
      <span class="nx">g_form</span><span class="p">.</span><span class="nx">setMandatory</span><span class="p">(</span><span class="s1">&#39;close_notes&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>             
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>           
    <span class="p">}</span>          
  <span class="p">}</span>         
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Make Closed Tasks Read-Only 
</p><p><b>Type:</b> Client Script 
</p><p><b>Table:</b> incident
</p><p><b>Description:</b> This script makes closed incidents read-only to Itil users, while allowing admin users to continue to edit them.  Note that because this script runs client-side, it is dependent on having the 'incident_state' field on the form (although this field could be hidden by a client script or UI policy). 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onLoad</span><span class="p">()</span> <span class="p">{</span>
   <span class="kd">var</span> <span class="nx">vincident_state</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;incident_state&#39;</span><span class="p">);</span>
   <span class="kd">var</span> <span class="nx">isItil</span> <span class="o">=</span> <span class="nx">g_user</span><span class="p">.</span><span class="nx">hasRole</span><span class="p">(</span><span class="s1">&#39;itil&#39;</span><span class="p">);</span>
   <span class="kd">var</span> <span class="nx">isAdmin</span> <span class="o">=</span> <span class="nx">g_user</span><span class="p">.</span><span class="nx">hasRole</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">);</span>
   <span class="kd">var</span> <span class="nx">incidentClosed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">vincident_state</span> <span class="o">==</span> <span class="mi">7</span> <span class="o">||</span> <span class="nx">vincident_state</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">incidentClosed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="kd">var</span> <span class="nx">dArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
   <span class="kd">var</span> <span class="nx">di</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">email_icon</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">attachment_icon</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">lookup_icon</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">infoBox_icon</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">calendar_icon</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">incidentClosed</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">email_icon</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="nx">attachment_icon</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="nx">lookup_icon</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="nx">infoBox_icon</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="nx">calendar_icon</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="nx">email_icon</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isAdmin</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">email_icon</span> <span class="o">||</span> <span class="o">!</span><span class="nx">attachment_icon</span> <span class="o">||</span> <span class="o">!</span><span class="nx">lookup_icon</span> <span class="o">||</span> <span class="o">!</span><span class="nx">infoBox_icon</span> <span class="o">||</span> <span class="o">!</span><span class="nx">calendar_icon</span><span class="p">))</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">refs</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">refs</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">refs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">ref</span> <span class="o">=</span> <span class="nx">refs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">inner</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">attachment_icon</span> <span class="o">&amp;&amp;</span> <span class="nx">inner</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;attachment.gifx&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">ref</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">email_icon</span> <span class="o">&amp;&amp;</span> <span class="nx">inner</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;email.gifx&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">ref</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lookup_icon</span> <span class="o">&amp;&amp;</span> <span class="nx">inner</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;reference_list.gifx&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">ref</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">infoBox_icon</span> <span class="o">&amp;&amp;</span> <span class="nx">inner</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;log.gifx&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">ref</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">calendar_icon</span> <span class="o">&amp;&amp;</span> <span class="nx">inner</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;small_calendar.gifx&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">ref</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>

         <span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;incident.do&#39;</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">form</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">x</span><span class="o">&lt;</span> <span class="nx">form</span><span class="p">.</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">form</span><span class="p">.</span><span class="nx">elements</span><span class="p">[</span><span class="nx">x</span><span class="p">].</span><span class="nx">disabled</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;This incident is closed and can only be updated by an administrator&#39;</span><span class="p">);</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Make Field Mandatory for Resolved Tasks 
</p><p><b>Type:</b> Client Script 
</p><p><b>Table:</b> incident
</p><p><b>Description:</b> These script makes a field mandatory once an incident is closed or resolved. The first script makes the field (u_mandatory) mandatory once the status changes. The second script makes the field (u_resolution) mandatory once the submit button is pressed. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<b>Option 1</b>: <div class="mw-highlight mw-content-ltr" dir="ltr"><pre> <span class="kd">function</span> <span class="nx">onChange</span><span class="p">(</span><span class="nx">control</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">newValue</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span> <span class="o">||</span> <span class="nx">newValue</span> <span class="o">==</span> <span class="s1">&#39;7&#39;</span><span class="p">)</span>
     <span class="nx">g_form</span><span class="p">.</span><span class="nx">setMandatory</span><span class="p">(</span><span class="s1">&#39;u_symptom&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="k">else</span>
     <span class="nx">g_form</span><span class="p">.</span><span class="nx">setMandatory</span><span class="p">(</span><span class="s1">&#39;u_symptom&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
 <span class="p">}</span>
</pre></div> <b>Option 2</b>: <div class="mw-highlight mw-content-ltr" dir="ltr"><pre> <span class="kd">function</span> <span class="nx">onSubmit</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">incident_state</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;incident_state&#39;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">sClsBtn</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="s1">&#39;close_incident&#39;</span> <span class="o">||</span> <span class="nx">incident_state</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span> <span class="o">||</span> <span class="nx">incident_state</span> <span class="o">==</span> <span class="s1">&#39;7&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">resolution</span><span class="o">=</span><span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;u_resolution&#39;</span><span class="p">);</span>  
      <span class="k">if</span> <span class="p">(</span><span class="nx">resolution</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span><span class="s1">&#39;&#39;</span>
          <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Resolution is mandatory&#39;</span><span class="p">);</span>
          <span class="kd">var</span> <span class="nx">sa_ctrl</span><span class="o">=</span><span class="nx">g_form</span><span class="p">.</span><span class="nx">getControl</span><span class="p">(</span><span class="s1">&#39;u_resolution&#39;</span><span class="p">);</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<table class="standard">

<tr>
<th> Criteria
</th>
<th> Value
</th></tr>
<tr>
<td> name
</td>
<td> Make Time Worked Related List Mandatory On Close
</td></tr>
<tr>
<td> type
</td>
<td> Client Scripts
</td></tr>
<tr>
<td> table
</td>
<td> incident
</td></tr>
<tr>
<td> param
</td>
<td> &#160;
</td></tr>
<tr>
<td> description
</td>
<td> In order to use a related list of time worked (allowing multiple users to log different time worked values), two client scripts need to be attached. First, an onLoad client script to stop the timer from going forward automatically, and secondly an onSubmit client script to check whehter a value has been added to the timer.
</td></tr></table>
<h1><span class="mw-headline" id="onLoad"><span class="mw-headline-number">1</span> onLoad</span></h1>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onLoad</span><span class="p">()</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">timer_field</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;incident.time_worked&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">timer_value</span> <span class="o">=</span> <span class="nx">timer_field</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">timer_value</span> <span class="o">!=</span> <span class="s2">&quot;00:00:00&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="nx">toggleTimerByFieldName</span><span class="p">(</span><span class="s1">&#39;incident.time_worked&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">toggleTimerByFieldName</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//Step 1: Find the timer object</span>

<span class="c1">//timeObjectName: the timer objects name as it would normally be reference</span>
<span class="c1">//timeObjectHidden: the hidden input node in the field td</span>
<span class="c1">//timeObjectParent: the parent td node containing the field and it&#39;s constituent nodes</span>
<span class="c1">//timeObjectFields: anchor tag with onclick to stop timer</span>

<span class="kd">var</span> <span class="nx">timeObjectName</span> <span class="o">=</span> <span class="nx">fieldName</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">timeObjectHidden</span> <span class="o">=</span> <span class="nx">gel</span><span class="p">(</span><span class="nx">timeObjectName</span><span class="p">);</span>

<span class="c1">//Step 2: simulate click on stop button</span>
<span class="kd">var</span> <span class="nx">timeObjectParent</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">timeObjectFields</span><span class="p">;</span>

<span class="c1">//verify that we got the correct object</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">timeObjectHidden</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s2">&quot;hidden&quot;</span><span class="p">)</span> <span class="p">{</span>

<span class="c1">//Get Parent td node</span>
<span class="nx">timeObjectParent</span> <span class="o">=</span> <span class="nx">timeObjectHidden</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>

<span class="c1">//Get input fields</span>
<span class="nx">timeObjectFields</span> <span class="o">=</span> <span class="nx">timeObjectParent</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span>

<span class="c1">//simulate click of stop button</span>
<span class="kd">var</span> <span class="nx">timerTestString</span> <span class="o">=</span> <span class="s2">&quot;paused&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">timerImg</span><span class="p">;</span>

<span class="c1">//loop through input objects looking for the pause timer object</span>
<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">elIt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">elIt</span><span class="o">&lt;</span><span class="nx">timeObjectFields</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">elIt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">timeObjectFields</span><span class="p">[</span><span class="nx">elIt</span><span class="p">].</span><span class="nx">id</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">timerTestString</span><span class="p">))</span> <span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="nx">timeObjectFields</span><span class="p">[</span><span class="nx">elIt</span><span class="p">].</span><span class="nx">value</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="nx">timeObjectFields</span><span class="p">[</span><span class="nx">elIt</span><span class="p">].</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span><span class="p">;</span>
<span class="nx">timerImg</span> <span class="o">=</span> <span class="nx">timeObjectParent</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="nx">timerImg</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;images/timer_start.gifx&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">timeObjectFields</span><span class="p">[</span><span class="nx">elIt</span><span class="p">].</span><span class="nx">value</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="nx">timeObjectFields</span><span class="p">[</span><span class="nx">elIt</span><span class="p">].</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;false&quot;</span><span class="p">;</span>
<span class="nx">timerImg</span> <span class="o">=</span> <span class="nx">timeObjectParent</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="nx">timerImg</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">&quot;images/timer_stop.gifx&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h1><span class="mw-headline" id="onSubmit_Script"><span class="mw-headline-number">2</span> onSubmit Script</span></h1>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onSubmit</span><span class="p">()</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">tw</span> <span class="o">=</span> <span class="nx">checkTimeWorked</span><span class="p">(</span><span class="s1">&#39;incident.time_worked&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">tw</span><span class="p">)</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="s2">&quot;The Time Worked field is Required. Please input the time worked on this incident.&quot;</span><span class="p">;</span>
<span class="nx">g_form</span><span class="p">.</span><span class="nx">showErrorBox</span><span class="p">(</span><span class="s2">&quot;time_worked&quot;</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">checkTimeWorked</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">timeObjectName</span> <span class="o">=</span> <span class="nx">fieldName</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">timeObjectHidden</span> <span class="o">=</span> <span class="nx">gel</span><span class="p">(</span><span class="nx">timeObjectName</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">timeObjectParent</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">timeObjectFields</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">timeObjectHidden</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s2">&quot;hidden&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="nx">timeObjectParent</span> <span class="o">=</span> <span class="nx">timeObjectHidden</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
<span class="nx">timeObjectFields</span> <span class="o">=</span> <span class="nx">timeObjectParent</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">timerTestString</span> <span class="o">=</span> <span class="s2">&quot;paused&quot;</span><span class="p">;</span>

<span class="c1">//loop through input objects looking for the pause timer object</span>
<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">elIt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">elIt</span><span class="o">&lt;</span><span class="nx">timeObjectFields</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">elIt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">timeObjectFields</span><span class="p">[</span><span class="nx">elIt</span><span class="p">].</span><span class="nx">id</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">timerTestString</span><span class="p">))</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">tof</span> <span class="o">=</span> <span class="nx">timeObjectFields</span><span class="p">[</span><span class="nx">elIt</span><span class="p">].</span><span class="nx">id</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">tmr_base</span> <span class="o">=</span> <span class="nx">tof</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">tof</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="p">(</span><span class="nx">timerTestString</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
<span class="kd">var</span> <span class="nx">tmr_hour</span> <span class="o">=</span> <span class="nx">tmr_base</span> <span class="o">+</span> <span class="s2">&quot;_hour&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">tmr_min</span> <span class="o">=</span> <span class="nx">tmr_base</span> <span class="o">+</span> <span class="s2">&quot;_min&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">tmr_sec</span> <span class="o">=</span> <span class="nx">tmr_base</span> <span class="o">+</span> <span class="s2">&quot;_sec&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">hour</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">tmr_hour</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">min</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">tmr_min</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sec</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">tmr_sec</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">two</span> <span class="o">=</span> <span class="nx">hour</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nx">min</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nx">sec</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">twn</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;time_worked&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">two</span> <span class="o">==</span> <span class="nx">twn</span><span class="p">)</span>
<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">hour</span> <span class="o">==</span> <span class="s1">&#39;00&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">min</span> <span class="o">==</span> <span class="s1">&#39;00&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Prevent Closure if Child Task is Active 
</p><p><b>Type:</b> "Before Update" Business Rule 
</p><p><b>Table:</b> 
</p><p><b>Description:</b> Prevents closing a task if any of the task's child tasks are still active. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">gr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">);</span>
<span class="nx">gr</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">);</span>
<span class="nx">gr</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;parent&#39;</span><span class="p">,</span><span class="nx">current</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span>
<span class="nx">gr</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">gr</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">setAbortAction</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Prevent Priority One Ticket Submission If Impact Isn't High 
</p><p><b>Type:</b> Client Script 
</p><p><b>Table:</b> 
</p><p><b>Description:</b>  
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">function</span> <span class="nx">onSubmit</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">priority</span> <span class="o">=</span> <span class="nx">gel</span><span class="p">(</span><span class="s1">&#39;incident.priority&#39;</span><span class="p">);</span>   
 <span class="kd">var</span> <span class="nx">impact</span> <span class="o">=</span> <span class="nx">gel</span><span class="p">(</span><span class="s1">&#39;incident.impact&#39;</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">priority</span><span class="p">)</span>
     <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">impact</span><span class="p">)</span>
     <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">priority</span><span class="p">.</span><span class="nx">value</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">impact</span><span class="p">.</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Cannot open a priority 1 incident on a low impact event&#39;</span><span class="p">);</span>
     <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div> 
<table cellspacing="5" cellpadding="5" style="border: 1px solid rgb(68, 68, 68); width: 70%; margin-bottom: 0.5em; margin-top: 0.5em; vertical-align: top; background-color: rgb(230, 230, 230);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Obsolete.gif.html" class="image" title="Obsolete"><img alt="Obsolete" src="images/d/d9/Obsolete.gif" width="20" height="20" /></a></div>
</td>
<td width="100%"> Functionality described here is obsolete since the <a href="index.php%3Ftitle=Spring_2009_Release_Notes.html" title="Spring 2009 Release Notes">Spring 2009</a> release and has been replaced by <a href="index.php%3Ftitle=Text_Search_Plugin.html" title="Text Search Plugin" class="mw-redirect">Global Text Search</a>.
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><br />
<b>Script Name:</b> Search Tasks with kb find 
</p><p><b>Type:</b> UI Page 
</p><p><b>Description:</b> The following script is a modification of the out-of-the-box "kb_find" UI page. It modifies the existing Knowledge Base search functionality by returning results from the Incident, Problem, and Change Request tables as well as the KB results. This script predates the <a href="index.php%3Ftitle=Text_Search_Plugin.html" title="Text Search Plugin" class="mw-redirect">Text Search Plugin</a>, which is a more global search and may be more suited to the situation. 
</p><p>The script is set up to return no more than 20 results from the task tables so as to avoid returning potentially thousands of results. The maximum number of results returned from the task tables can be changed by modifying the "&lt;j2:while test="$[ctr&#160;!= 20]"&gt;" line below. 
</p><p>You can implement this script simply by replacing the code in the out-of-the-box "kb_find" UI page with the code below. The "kb_find" page can be found by navigating to the "System UI" application and selecting the "UI Pages" module. 
</p><p><b>Script</b> 
</p>
<pre>
&lt;?xml version="1.0" encoding="utf-8"&#160;?&gt;
&lt;!--
 Knowledge management v2 - list viewer 
--&gt;
&lt;j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null"&gt;
 &lt;link href="kb_styles.cssx" type="text/css" rel="stylesheet" /&gt;
 &lt;SCRIPT LANGUAGE="JavaScript" SRC="kb.jsx?v=${gs.getProperty('glide.builddate')}" /&gt;
 
 &lt;g2:evaluate jelly="true" var="jvar_item"&gt;
 var kb = new GlideRecord('kb_knowledge');
 var task = new GlideRecord('task');
 var qc = task.addQuery('sys_class_name', 'problem');
 qc.addOrCondition('sys_class_name', 'incident');
 qc.addOrCondition('sys_class_name', 'change_request');
 &lt;!--task.orderByAsc('number');--&gt;
 
 
 var operator = 'IR_AND_QUERY';
 if (jelly.sysparm_operator) 
 operator = jelly.sysparm_operator;
 
 if (jelly.sysparm_search $[AND] jelly.sysparm_search.length&#160;!= 0)
 kb.addQuery(operator, jelly.sysparm_search);
 task.addQuery(operator, jelly.sysparm_search);
 
 if (jelly.sysparm_topic $[AND] jelly.sysparm_topic.length&#160;!= 0 $[AND] jelly.sysparm_topic&#160;!= 'null') {
 gs.print("adding topic = " + jelly.sysparm_topic);
 kb.addQuery('topic', jelly.sysparm_topic);
 }
 
 if (jelly.sysparm_category $[AND] jelly.sysparm_category.length&#160;!= 0 $[AND] jelly.sysparm_topic&#160;!= 'null') {
 gs.print("adding category = " + jelly.sysparm_category);
 kb.addQuery('category', jelly.sysparm_category);
 }
 
 kb.addQuery('active', 'true');
 kb.addQuery('workflow_state', 'published');
 var orderField = 'relevancy';
 var sortSequence = gs.getProperty('glide.knowman.order.search');
 if (sortSequence&#160;!= 'relevancy') {
   kb.orderByDesc('sys_view_count');
   orderField = 'view count';
 }
 kb.query();
 
 &lt;j2:if test="$[gs.hasRole('itil')]"&gt;
 task.query();
 &lt;/j2:if&gt;
 
 &lt;/g2:evaluate&gt;
 
 &lt;table class="wide" cellspacing="0" border="0" style="margin-bottom: 8px;"&gt;
 &lt;tr&gt;
 &lt;td class="title" nowrap="true" colspan="99"&gt;
 &lt;g:inline template="kb_header.xml" /&gt;
 &lt;/td&gt;
 &lt;/tr&gt;
 &lt;/table&gt;
 &lt;table class="wide" cellspacing="0" border="0" style="margin-bottom: 8px;"&gt;
 &lt;tr class="header" border="0" cellspacing="0"&gt;
 &lt;td class="column_head" colspan="3"&gt;
 &lt;table border="0" cellspacing="0" cellpadding="0"&gt;
 &lt;tr class="header" border="0" cellspacing="0"&gt;
 &lt;form method="GET" action="${sysparm_base_form}.do" name="${sysparm_base_form}.do"&gt;
 &lt;input type="HIDDEN" name="sys_action" value="none" /&gt;
 &lt;g2:emitParms suppress="sysparm_this_url_enc" /&gt;
 &lt;input type="HIDDEN" name="sysparm_modify_check" value="true" /&gt;
 &lt;td&gt;
 &lt;input type="HIDDEN" id="sysverb_back" /&gt;
 &lt;img name="not_important" 
 value="sysverb_back" 
 id="sysverb_back" 
 onClick="return gsftSubmit(document.getElementById('sysverb_back'));" 
 src="images/green_back.gifx" 
 title="${gs.getMessage('Back')}" 
 alt="${gs.getMessage('Back')}" 
 style="cursor:hand; margin-left: 4px;"/&gt;
 &lt;/td&gt;
 &lt;/form&gt;
 &lt;td&gt;
 &lt;div class="caption" style="margin-top: 2px;"&gt;
   $[gs.getMessage('kb.banner.title')] 
   $[gs.getMessage('search results')]
   ($[gs.getMessage('sorted by')] $[gs.getMessage(orderField)])
 &lt;/div&gt;
 &lt;/td&gt;
 &lt;/tr&gt;
 &lt;/table&gt;
 &lt;/td&gt;
 &lt;/tr&gt;
 &lt;j2:set var="jvar_printed_some" value="false"/&gt;
 &lt;j2:set var="jvar_printed_some_task" value="false"/&gt; 
	&lt;g2:inline template="kb_search_results.xml"/&gt;
	&lt;j2:if test="$[jvar_printed_some == false]"&gt;
		&lt;g2:evaluate var="jvar_item" expression="gs.flushMessages();"/&gt;
		&lt;tr&gt;
		&lt;td&gt;
		   &lt;div class="kb_no_text"&gt;Your search - &lt;span class="kb_stand_out"&gt;$[sysparm_search]&lt;/span&gt; - did not match any documents.&lt;/div&gt;
		&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/j2:if&gt; 
 
&lt;tr border="0" cellspacing="0"&gt;&lt;td&gt;&lt;br /&gt;&lt;/td&gt;&lt;/tr&gt; 
 
&lt;tr class="header" border="0" cellspacing="0"&gt;
&lt;td class="column_head" colspan="3"&gt;
&lt;table border="0" cellspacing="0" cellpadding="0"&gt;
 &lt;tr class="header" border="0" cellspacing="0"&gt;
 &lt;form method="GET" action="${sysparm_base_form}.do" name="${sysparm_base_form}.do"&gt;
 &lt;input type="HIDDEN" name="sys_submitted" value="false" /&gt;
 &lt;input type="HIDDEN" name="sys_action" value="none" /&gt;
 &lt;g2:emitParms suppress="sysparm_this_url_enc" /&gt;
 &lt;input type="HIDDEN" name="sysparm_modify_check" value="true" /&gt;
 &lt;td&gt;
 &lt;input type="HIDDEN" id="sysverb_back" /&gt;
 &lt;img name="not_important" 
 value="sysverb_back" 
 id="sysverb_back" 
 onClick="return gsftSubmit(document.getElementById('sysverb_back'));" 
 src="images/green_back.gifx" 
 title="${gs.getMessage('Back')}" 
 alt="${gs.getMessage('Back')}" 
 style="cursor:hand; margin-left: 4px;"/&gt;
 &lt;/td&gt;
 &lt;/form&gt;
 &lt;td&gt;
 &lt;div class="caption" style="margin-top: 2px;"&gt;
 Task results
 &lt;/div&gt;
 &lt;/td&gt;
 &lt;/tr&gt;
 &lt;/table&gt;
&lt;/td&gt;
&lt;/tr&gt;
 
&lt;g2:evaluate&gt;
 var ctr = 0;
&lt;/g2:evaluate&gt;
 
 &lt;j2:set var="jvar_print_section" value="false"/&gt;
 &lt;j2:while test="$[ctr&#160;!= 20]"&gt;
 &lt;g2:evaluate&gt;
 &lt;j2:if test="$[task.next()]"&gt;
 &lt;j2:set var="jvar_print_section" value="true"/&gt;
 &lt;/j2:if&gt;
 &lt;/g2:evaluate&gt; 
 &lt;j2:if test="$[jvar_print_section == true]"&gt;
 &lt;j2:set var="jvar_printed_some_task" value="true"/&gt;
 &lt;j2:set var="jvar_task_link" value="task.do?sys_id=$[task.sys_id]"/&gt;
 &lt;tr&gt;
 &lt;td&gt;
 &lt;div style="margin-top: 10px;"&gt;&lt;/div&gt;
 &lt;g2:evaluate var="jvar_desc"&gt;
 var answer = task.short_description;
 answer;
 &lt;/g2:evaluate&gt;
 &lt;div&gt;&lt;a href="$[jvar_task_link]" class="kb_search_header"&gt;&lt;g2:highlighter search="$[sysparm_search]"&gt;$[jvar_desc]&lt;/g2:highlighter&gt;&lt;/a&gt;&lt;/div&gt;
 &lt;div&gt;&lt;g2:highlighter search="$[sysparm_search]"&gt;$[task.description]&lt;/g2:highlighter&gt;&lt;/div&gt;
 &lt;div class="kb_add_info"&gt;
 Result type:$[SP]&lt;font style="text-transform: uppercase;"&gt;$[task.sys_class_name]&lt;/font&gt;$[SP]&gt;
 &lt;j2:set var="jvar_got_stackname" value="$[sysparm_nameofstack.length() &gt; 0]"/&gt;
 &lt;j2:if test="$[jvar_got_stackname == false]"&gt;
 &lt;a class="kb_add_info_link" href="task.do?sys_id=$[task.sys_id]"&gt;$[task.number]&lt;/a&gt;
 &lt;/j2:if&gt;
 &lt;/div&gt;
 &lt;/td&gt;
 &lt;/tr&gt;
 &lt;/j2:if&gt;
 &lt;g2:evaluate&gt; 
 ctr++;
 &lt;/g2:evaluate&gt;
 &lt;j2:set var="jvar_print_section" value="false"/&gt; 
 &lt;/j2:while&gt;
 
 &lt;j2:if test="$[jvar_printed_some_task == false]"&gt;
 &lt;g2:evaluate var="jvar_item" expression="gs.flushMessages();"/&gt;
 &lt;tr&gt;
 &lt;td&gt;
 &lt;div class="kb_no_text"&gt;Your search - &lt;span class="kb_stand_out"&gt;$[sysparm_search]&lt;/span&gt; - did not match any Tasks.&lt;/div&gt;
 &lt;/td&gt;
 &lt;/tr&gt;
 &lt;/j2:if&gt;
 
 &lt;/table&gt;
&lt;/j:jelly&gt;
</pre>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Warn User Before Submitting a Priority One Ticket 
</p><p><b>Type:</b> onSubmit Client Script 
</p><p><b>Table:</b> Incident
</p><p><b>Description:</b> An onSubmit Client Script throws an alert if a ticket is inserted with <b>Priority</b> = 1. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// Only alert if ticket is being inserted (as opposed to modified)</span>
<span class="kd">function</span> <span class="nx">onSubmit</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">confirm</span><span class="p">(</span><span class="s1">&#39;Submit a priority one ticket?&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Update Incident with Attachments 
</p><p><b>Type:</b> Inbound Email Action 
</p><p><b>Table:</b> 
</p><p><b>Description:</b> The following <b>Inbound Email Action</b> when used in an "Update" or "Replied" rule, will copy the attachment to the current table that is being updated. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>This API call changed in the Calgary release:</i>
<ul><li><i>GlideSysAttachment</i> replaces <i>Packages.com.glide.ui.SysAttachment</i> </li></ul>
<p>The new script object calls apply to the Calgary release and beyond. For releases prior to Calgary, substitute the packages call as described above. Packages calls are not valid beginning with the Calgary release. For more information, see <a href="index.php%3Ftitle=Scripting_API_Changes.html" title="Scripting API Changes">Scripting API Changes</a>.
</p>
</td></tr></table>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// query for the sys_email record (incoming email) that contains the attachment</span>
<span class="kd">var</span> <span class="nx">email_log</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;sys_email&#39;</span><span class="p">);</span>
<span class="nx">email_log</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="nx">email</span><span class="p">.</span><span class="nx">uid</span><span class="p">);</span>
<span class="nx">email_log</span><span class="p">.</span><span class="nx">orderByDesc</span><span class="p">(</span><span class="s1">&#39;sys_created_on&#39;</span><span class="p">);</span>
<span class="nx">email_log</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nx">email_log</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// Add the attachment to task</span>
  <span class="nx">GlideSysAttachment</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="s2">&quot;sys_email&quot;</span><span class="p">,</span> <span class="nx">email_log</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sys_class_name</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<p><b>Name:</b> Validate Change Windows 
</p><p><b>Type:</b>  
</p><p><b>Table:</b> 
</p><p><b>Description:</b> This uses both a client script and a global business rule (called via AJAX) to validate a change window against a schedule attached to the configuration item. 
</p><p><b>Parameters:</b> 
</p>
<b>Script:</b> <b>Client script</b> <div class="mw-highlight mw-content-ltr" dir="ltr"><pre> <span class="kd">function</span> <span class="nx">onChange</span><span class="p">(</span><span class="nx">control</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
 
  <span class="k">if</span> <span class="p">(</span><span class="nx">isLoading</span><span class="p">){</span>
      <span class="k">return</span><span class="p">;</span>
   <span class="p">}</span>
 
   <span class="kd">var</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">);</span>
   <span class="kd">var</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;end_date&#39;</span><span class="p">);</span>
   <span class="kd">var</span> <span class="nx">scheduleID</span> <span class="o">=</span> <span class="nx">g_form</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="s1">&#39;u_maint_window&#39;</span><span class="p">);</span>
 
   <span class="k">if</span><span class="p">(</span><span class="nx">startDate</span><span class="o">&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">endDate</span><span class="o">&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">scheduleID</span><span class="o">&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
      <span class="nx">g_form</span><span class="p">.</span><span class="nx">hideErrorBox</span><span class="p">(</span><span class="s2">&quot;u_maint_window&quot;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">ajax</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideAjax</span><span class="p">(</span><span class="s1">&#39;MySysScriptInclude&#39;</span><span class="p">);</span>
      <span class="nx">ajax</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s1">&#39;sysparm_name&#39;</span><span class="p">,</span><span class="s1">&#39;globalCheckWindows&#39;</span><span class="p">);</span>
      <span class="nx">ajax</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s1">&#39;sysparm_start_date&#39;</span><span class="p">,</span><span class="nx">startDate</span><span class="p">);</span>
      <span class="nx">ajax</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s1">&#39;sysparm_end_date&#39;</span><span class="p">,</span><span class="nx">endDate</span><span class="p">);</span>
      <span class="nx">ajax</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s1">&#39;sysparm_schedule_id&#39;</span><span class="p">,</span><span class="nx">scheduleID</span><span class="p">);</span>
      <span class="nx">ajax</span><span class="p">.</span><span class="nx">getXMLWait</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">answer</span> <span class="o">=</span> <span class="nx">ajax</span><span class="p">.</span><span class="nx">getAnswer</span><span class="p">();</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">answer</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span><span class="p">){</span>
 
      <span class="p">}</span>
      <span class="k">else</span><span class="p">{</span>
         <span class="nx">g_form</span><span class="p">.</span><span class="nx">showErrorBox</span><span class="p">(</span><span class="s2">&quot;u_maint_window&quot;</span><span class="p">,</span> <span class="s2">&quot;Start/End dates are not within the specified change window.&quot;</span><span class="p">);</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div> <b>System Script Include:</b> 
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>These API calls changed in the Calgary release:</i>
<ul><li><i>GlideDateTime</i> replaces <i>Packages.com.glide.glideobject.GlideDateTime</i></li>
<li><i>GlideSchedule</i> replaces <i>Packages.com.glide.schedules.Schedule</i> </li></ul>
<p>The new script object calls apply to the Calgary release and beyond. For releases prior to Calgary, substitute the packages calls as described above. Packages calls are not valid beginning with the Calgary release. For more information, see <a href="index.php%3Ftitle=Scripting_API_Changes.html" title="Scripting API Changes">Scripting API Changes</a>.
</p>
</td></tr></table>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre> 
<span class="kd">var</span> <span class="nx">MySysScriptInclude</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
 
<span class="nx">MySysScriptInclude</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">extendsObject</span><span class="p">(</span><span class="nx">AbstractAjaxProcessor</span><span class="p">,</span> <span class="p">{</span> 

<span class="nx">globalCheckWindows</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
 
<span class="kd">var</span> <span class="nx">sDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getParameter</span><span class="p">(</span><span class="s1">&#39;sysparm_start_date&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">eDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getParameter</span><span class="p">(</span><span class="s1">&#39;sysparm_end_date&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">scheduleID</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getParameter</span><span class="p">(</span><span class="s1">&#39;sysparm_schedule_id&#39;</span><span class="p">);</span>
 
<span class="kd">var</span> <span class="nx">start_date</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideDateTime</span><span class="p">();</span>
<span class="nx">start_date</span><span class="p">.</span><span class="nx">setDisplayValue</span><span class="p">(</span><span class="nx">sDate</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">end_date</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideDateTime</span><span class="p">();</span>
<span class="nx">end_date</span><span class="p">.</span><span class="nx">setDisplayValue</span><span class="p">(</span><span class="nx">eDate</span><span class="p">);</span>
 
<span class="kd">var</span> <span class="nx">wall_clock_time</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">gs</span><span class="p">.</span><span class="nx">dateDiff</span><span class="p">(</span><span class="nx">sDate</span><span class="p">,</span> <span class="nx">eDate</span><span class="p">,</span> <span class="kc">true</span><span class="p">));</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Wall clock duration: &#39;</span> <span class="o">+</span> <span class="nx">wall_clock_time</span><span class="p">);</span>
 
<span class="kd">var</span> <span class="nx">g</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;cmn_schedule&#39;</span><span class="p">);</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;sys_id&#39;</span><span class="p">,</span> <span class="nx">scheduleID</span><span class="p">);</span>
<span class="nx">g</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">answer</span> <span class="o">=</span> <span class="s1">&#39;false&#39;</span><span class="p">;</span>
 
<span class="k">while</span> <span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">sched</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideSchedule</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">dur</span> <span class="o">=</span> <span class="nx">sched</span><span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="nx">start_date</span><span class="p">,</span> <span class="nx">end_date</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">schedule_time</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">dur</span><span class="p">.</span><span class="nx">getNumericValue</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Schedule duration: &#39;</span> <span class="o">+</span> <span class="nx">schedule_time</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">wall_clock_time</span> <span class="o">==</span> <span class="nx">schedule_time</span><span class="p">){</span>
<span class="nx">answer</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">else</span><span class="p">{</span>
<span class="nx">answer</span> <span class="o">=</span> <span class="s1">&#39;false&#39;</span><span class="p">;</span>
<span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">return</span> <span class="nx">answer</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<!-- 
NewPP limit report
Cached time: 20171201102816
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.714 seconds
Real time usage: 9.705 seconds
Preprocessor visited node count: 495/1000000
Preprocessor generated node count: 1395/1000000
Post‐expand include size: 46797/2097152 bytes
Template argument size: 5021/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00% 9319.837      1 - -total
 12.76% 1189.107      1 - Change_Urgency_to_High_if_User_is_VIP
  9.40%  875.863      1 - Find_Computer_Assigned_to_Caller_and_Populate_CI_Field
  7.94%  739.849      1 - Duplicate_a_Record_Along_with_Related_List
  7.56%  704.502      1 - Close_and_Cascade_Comments_to_Child_Tasks
  6.52%  607.945      1 - Validate_Change_Windows
  5.81%  541.399      1 - Make_Time_Worked_Related_List_Mandatory_On_Close
  5.72%  533.186      1 - Auto-Assign_to_User_on_Accept
  5.40%  503.085      1 - Display_Task_Number_as_Window_Title
  5.38%  501.180      1 - Log_Group_Activity
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:6114-0!*!0!1!*!5!* and timestamp 20171201102806 and revision id 83717
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php%3Ftitle=Useful_Task_Scripts&amp;oldid=83717.html">http://wiki.servicenow.com/index.php?title=Useful_Task_Scripts&amp;oldid=83717</a>"</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="index.php%3Ftitle=Special:Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Useful+Scripts.html" title="Category:Useful Scripts">Useful Scripts</a></li><li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Task+Scripts.html" title="Category:Task Scripts">Task Scripts</a></li><li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Incident+Management.html" title="Category:Incident Management">Incident Management</a></li></ul></div><br /><hr /><a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Contents</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Deliver.html" title="Category:Deliver">Deliver</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=IT+Services.html" title="Category:IT Services">IT Services</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Incident+Management.html" title="Category:Incident Management">Incident Management</a><br />
<a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Contents</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Script.html" title="Category:Script">Script</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Useful+Scripts.html" title="Category:Useful Scripts">Useful Scripts</a><br />
<a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Contents</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Script.html" title="Category:Script">Script</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Useful+Scripts.html" title="Category:Useful Scripts">Useful Scripts</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Task+Scripts.html" title="Category:Task Scripts">Task Scripts</a></div>					<!-- end content -->
					<div id='mw-data-after-content'>
	<div id="rating_6114"><div class="voting-title">Was this article helpful?</div><div class="voting-box"><div class="vote-up " data-vote-id="6114" data-vote-the-vote="5" data-vote-id="6114" data-vote-action="5" data-vote-rating="4.00" data-vote-voted="0" id="rating_6114_5"><span>Yes, I found what I needed</span></div><div class="vote-down " data-vote-id="6114" data-vote-the-vote="1" data-vote-id="6114" data-vote-action="5" data-vote-rating="4.00" data-vote-voted="0" id="rating_6114_1"><span>No, I need more assistance</span></div></div></div>
</div>
					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
					<div id="p-cactions" class="portlet" role="navigation">
			<h5>Views</h5>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php%3Ftitle=Useful_Task_Scripts.html" title="View the content page [c]" accesskey="c">Page</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h5>Personal tools</h5>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="index.php%3Ftitle=Special:CreateAccount&amp;returnto=Useful+Task+Scripts&amp;returntoquery=printable%253Dyes.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="index.php%3Ftitle=Special:UserLogin&amp;returnto=Useful+Task+Scripts&amp;returntoquery=printable%253Dyes.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-" role="navigation">
		<h3></h3>
		<div class='pBody'>
			<div class="portlet">
<h5><span class="mw-headline" id="Categories">Categories</span></h5>
<div class="pBody">
<div class="sidebarcat">
<ul><li><a href="index.php%3Ftitle=Get_Started.html" title="Get Started">Get Started</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Use+ServiceNow&amp;oldid=0.html" title="Use ServiceNow">Use</a></li>
<li><a href="index.php%3Ftitle=Administer_ServiceNow.html" title="Administer ServiceNow">Administer</a></li>
<li><a href="index.php%3Ftitle=Script_in_ServiceNow.html" title="Script in ServiceNow">Script</a></li>
<li><a href="index.php%3Ftitle=Build.html" title="Build">Build</a></li>
<li><a href="index.php%3Ftitle=Deliver_ServiceNow.html" title="Deliver ServiceNow">Deliver</a></li>
<li><a href="index.php%3Ftitle=Integration_Overview.html" title="Integration Overview">Integrate</a></li>
<li><a href="index.php%3Ftitle=Release_Notes.html" title="Release Notes">Release Notes</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Customer+Support&amp;oldid=0.html" title="Customer Support">Customer Support</a></li>
<li><a href="index.php%3Ftitle=Books.html" title="Books">Books</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Video+Tutorials&amp;oldid=0.html" title="Video Tutorials">Video Tutorials</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://express.servicenow.com/support/">ServiceNow Express</a></li></ul>
</div>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Resources">Resources</span></h5>
<div class="pBody">
<ul><li><a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Site Map &#8211; Tree View</a><br /></li>
<li><a href="index.php%3Ftitle=Special:RecentChanges.html" title="Special:RecentChanges">Recent Changes</a><br /></li>
<li><a href="index.php%3Ftitle=Glossary_of_Terms.html" title="Glossary of Terms">Glossary</a><br /></li>
<li><a href="index.php%3Ftitle=Help:Getting_Started_on_the_ServiceNow_Wiki.html" title="Help:Getting Started on the ServiceNow Wiki">Wiki Help</a></li></ul>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Print">Print</span></h5>
<div class="pBody">
<ul><li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book&amp;bookcmd=book_creator.html">Create a Book</a></li>
<li><a href="index.php%3Ftitle=Help:Books.html" title="Help:Books">Book Help</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book%252Frender_article%252F&amp;arttitle=Useful_Task_Scripts.html">Download Page as PDF</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Useful_Task_Scripts&amp;printable=yes.html">Printable Version</a></li></ul>
</div>
</div>
		</div>
		</div>
		<div class="generated-sidebar portlet" id="p-coll-print_export" role="navigation">
		<h3>Print/export</h3>
		<div class='pBody'>
							<ul>
											<li id="coll-book_creator_disable"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Useful+Task+Scripts.html">Disable book creator</a></li>
											<li id="coll-download-as-rl"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=render_article&amp;arttitle=Useful+Task+Scripts&amp;returnto=Useful+Task+Scripts&amp;oldid=83717&amp;writer=rl.html">Download as PDF</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://wiki.servicenow.com/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search ServiceNow Wiki [f]" accesskey="f" id="searchInput"/>
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton"/>&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Toolbox</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="index.php%3Ftitle=Special:WhatLinksHere%252FUseful_Task_Scripts.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here?</a></li>
											<li id="t-recentchangeslinked"><a href="http://wiki.servicenow.com/index.php?title=Special:RecentChangesLinked/Useful_Task_Scripts" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="index.php%3Ftitle=Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-permalink"><a href="index.php%3Ftitle=Useful_Task_Scripts&amp;oldid=83717.html" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="index.php%3Ftitle=Useful_Task_Scripts&amp;action=info.html" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified 20:06, 7 July 2011.</li>
									<li id="privacy"><a href="index.php%3Ftitle=ServiceNow_Wiki:Privacy_policy.html" title="ServiceNow Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="index.php%3Ftitle=ServiceNow_Wiki:About.html" title="ServiceNow Wiki:About">About ServiceNow Wiki</a></li>
									<li id="disclaimer"><a href="index.php%3Ftitle=ServiceNow_Wiki:General_disclaimer.html" title="ServiceNow Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["ext.treeandmenu","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.collection.bookcreator"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":870});});</script></body></html>
