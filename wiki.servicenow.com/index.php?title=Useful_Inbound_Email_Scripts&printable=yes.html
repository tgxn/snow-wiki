<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8"/>
<title>Useful Inbound Email Scripts - ServiceNow Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Useful_Inbound_Email_Scripts","wgTitle":"Useful Inbound Email Scripts","wgCurRevisionId":250973,"wgRevisionId":250973,"wgArticleId":6118,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Useful Scripts","Inbound Email Scripts"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Useful_Inbound_Email_Scripts","wgRelevantArticleId":6118,"wgRequestId":"0683eb24ca2fde91a65261c7","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":20,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup","ext.voteNY"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=ext.pygments%257Cmediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cmediawiki.skinning.content.externallinks%257Cmediawiki.skinning.interface%257Cskins.monobook.styles&amp;only=styl.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;printable=1&amp;skin=monobook.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.27.3"/>
<meta name="robots" content="noindex,follow"/>
<meta name="robots" content="index,follow,noarchive"/>
<meta name="copyright" content="ServiceNow"/>
<meta http-equiv="content-language" content="en"/>
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<meta name="modified" content="20170912185740"/>
<meta name="canonical" content="//wiki.servicenow.com/index.php?title=Useful_Inbound_Email_Scripts"/>
<meta name="author" content="ServiceNow"/>
<meta name="twitter:card" content="@NOWsupport"/>
<meta name="twitter:title" content="Useful Inbound Email Scripts"/>
<meta name="twitter:creator" content="@NOWsupport"/>
<meta name="twitter:domain" content="servicenow.com"/>
<meta name="keywords" content="Inbound Email Scripts"/>
<meta name="category" content="Inbound Email Scripts"/>
<link rel="shortcut icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="ServiceNow Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php%3Faction=rsd"/>
<link rel="alternate" type="application/atom+xml" title="ServiceNow Wiki Atom feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=atom.html"/>
<script type="text/javascript">window.tamBaseUrl='/extensions/TreeAndMenu'</script>

<script type="text/javascript" src="extensions/TreeAndMenu/dtree.js"></script>

<link rel="canonical" href="index.php%3Ftitle=Useful_Inbound_Email_Scripts.html" />

	<meta property="og:title" content="ServiceNow Wiki:Useful Inbound Email Scripts"/>

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ServiceNow Wiki"/>

	<meta property="modified" content="20170912185740"/>

	<meta property="article:published_time" content="20170912185740"/>

	<meta property="article:modified_time" content="20170912185740"/>

	<meta property="article:author" content="ServiceNow"/>

	<meta property="article:tag" content="Inbound Email Scripts"/>

	<meta property="og:url" content="//wiki.servicenow.com/index.php?title=Useful_Inbound_Email_Scripts"/>

</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Useful_Inbound_Email_Scripts rootpage-Useful_Inbound_Email_Scripts skin-monobook action-view">
<div id="header">
	<div id="snc_top_toolbar" >
	<ul class="inline" id="sites">
		<li><a href="index.html">Wiki home</a></li>
		<li><a href="http://community.servicenow.com">Community</a></li>
		<li><a href="http://www.servicenow.com/services/training-and-certification.html">Training</a></li>
		<li><a href="https://www.servicenow.com/support.html">Support home</a></li>
		<li><a href="http://www.servicenow.com">Company home</a></li>
		<li><a href="http://info.servicenow.com/demonow/">Demo</a></li>
	</ul>

<!-- Start Adobe analytics staging -->
<script src="http://assets.adobedtm.com/43c21e31f00ba1c49c16c9c6a5acf67ef1e8dfa8/satelliteLib-c41330e93f48feef745e6ecb4b425db9d5da2dea.js"></script>

<!--Begin Google analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29210697-1']);
  _gaq.push(['_setDomainName', 'servicenow.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  _gaq.push(['_trackPageLoadTime']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- End Google analytics, begin other analytics -->

<!--<script type="text/javascript" language="javascript">llactid=11051</script>
<script type="text/javascript" language="javascript" src="https://trackalyzer.com/trackalyze_secure.js"></script>
-->
<!--End analytics-->

	</div>
</div>
<div id="snc_toolbar" >
	<a href="index.html">
	<img src="https://wiki.service-now.com/images/CustomWikiLogoFixed.png" height="64px">
	</a>
<div id="googleSearchBox"> <!--Google Search box -->
<div id='cse-search-form' style='width: 100%;'>Loading</div>
<script src='http://www.google.com/jsapi' type='text/javascript'></script>


<script type='text/javascript'>

google.load('search', '1', {language: 'en', style: google.loader.themes.V2_DEFAULT, callback:loadCSE});

window.onhashchange = function() {
	var url = window.location.href;
	if(url.indexOf("gsc.q") == -1) //call only when not browsing search results.
	{
		resetUI();
	}
}

function resetUI() {
	//reset UI to standard layout. Hide search, restore page content/controls.
	var cactions = document.getElementById('p-cactions');
	var cont = document.getElementById('content');
	var sr = document.getElementById('cse');

	cactions.style.display = 'block';
	sr.style.display = 'none';
	cont.style.display = 'block';
};

function onSubmit() {
	//hide page elements when searching.
	var cactions = document.getElementById('p-cactions');
	cactions.style.display = 'none';
	var sr = document.getElementById('cse');
	sr.style.display = 'block';
	var cont = document.getElementById('content');
	cont.style.display = 'none';
};

function loadCSE() {
	var customSearchOptions = {};
	var orderByOptions = {};
	orderByOptions['keys'] = [{label: 'Relevance', key: ''} , {label: 'Date', key: 'date'}];
	customSearchOptions['enableOrderBy'] = true;
	customSearchOptions['orderByOptions'] = orderByOptions;

	var customSearchControl = new google.search.CustomSearchControl('005409823165138974380:bltnnmgfoek', customSearchOptions);
	customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
	customSearchControl.setSearchCompleteCallback(this,onSubmit);//set onSubmit script to run when searching

	var options = new google.search.DrawOptions();
	options.setSearchFormRoot('cse-search-form');
	options.setAutoComplete(true);
	customSearchControl.draw('cse', options);
	var historyStarted = customSearchControl.startHistoryManagement();
	if(historyStarted) customSearchControl.setLinkTarget(google.search.Search.LINK_TARGET_SELF);
};

</script>

</div> <!--end Google search box-->
</div>

<div id="globalWrapper">
		<div id="column-content">
			<div id="cse"></div>
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div class="collection-creatorbox"><img src="extensions/Collection/images/Open_book.png%3F9" alt="" width="80" height="45" class="collection-creatorbox-book" /><div class="collection-creatorbox-row"><div><a href="index.php%3Ftitle=Help:Books.html" title="Show help about creating books" rel="nofollow"><img src="extensions/Collection/images/silk-help.png" alt="" width="16" height="16" />&#160;Help</a></div><span class="collection-creatorbox-title">Book creator</span> (<a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Useful+Inbound+Email+Scripts.html" title="Stop using the book creator" rel="nofollow">disable</a>)</div><div id="coll-book_creator_box" class="collection-creatorbox-row"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Useful+Inbound+Email+Scripts&amp;oldid=0.html" title="Add the current wiki page to your book" id="coll-add_article" rel="nofollow" onclick="collectionCall('AddArticle', ['removearticle', wgNamespaceNumber, wgTitle, &quot;0&quot;]); return false;"><img src="extensions/Collection/images/silk-add.png" alt="" width="16" height="16" />&#160;Add this page to your book</a><a href="index.php%3Ftitle=Special:Book%252Fload_collection%252F&amp;colltitle=Book:Introduction_to_ServiceNow_Part_1.html" title="Click to edit/download/order your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-book_open.png" alt="" width="16" height="16" />&#160;Show book (500 pages)</a><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=suggest.html" title="Show suggestions based on the pages in your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-wand.png" alt="" width="16" height="16" style="vertical-align: text-bottom" />&#160;Suggest pages</a></div></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Useful Inbound Email Scripts</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From ServiceNow Wiki</div>
					<div id="contentSub"><!-- Text for discussion pages-->
<a href="index.html" title="Main Page">Home</a> &gt; <a href="index.php%3Ftitle=Script_in_ServiceNow.html" title="Script in ServiceNow">Script</a> &gt; <a href="index.php%3Ftitle=Useful_Scripts_Portal.html" title="Useful Scripts Portal">Useful Scripts</a> &gt; Useful Inbound Email Scripts</div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php%3Ftitle=Useful_Inbound_Email_Scripts&amp;printable=yes.html#column-one">navigation</a>, <a href="index.php%3Ftitle=Useful_Inbound_Email_Scripts&amp;printable=yes.html#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>This article applies to Fuji and earlier releases. For more current information, see <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="https://docs.servicenow.com/bundle/jakarta-servicenow-platform/page/administer/notification/concept/c_InboundEmailActions.html">Inbound Email Actions</a> at <a target="_blank" rel="nofollow noreferrer noopener" class="external free" href="http://docs.servicenow.com">http://docs.servicenow.com</a></i>
<p><b>The ServiceNow Wiki is no longer being updated. Visit <a target="_blank" rel="nofollow noreferrer noopener" class="external free" href="http://docs.servicenow.com">http://docs.servicenow.com</a> for the latest product documentation.</b>
</p>
</td></tr></table>
<p>This is a searchable version of the Useful Inbound Email Scripts. For an easy-to-navigate version, visit the <a href="index.php%3Ftitle=Useful_Scripts_portal.html" title="Useful Scripts portal" class="mw-redirect">Useful Scripts portal</a>. 
</p>
<hr />
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <tt>body</tt> and <tt>message</tt> fields on the Notification form were changed to <tt>body_html</tt>, <tt>body_text</tt>, <tt>message_html</tt>, and <tt>message_text</tt> in the Eureka release.</i>
</td></tr></table>
<p><br />
<b>Name:</b> Add All Email Recipients to Watch List 
</p><p><b>Type:</b>  
</p><p><b>Table:</b> 
</p><p><b>Description:</b> This inbound email action takes all recipients (cc'd or to), checks to see if they are a user or a group, and puts them into the user (or group) watchlist on the appropriate incident. This ensures that everyone who has ever been copied on an email will get all future updates as well. NOTE: This requires the creation of a second watch list on the incident form, called 'Group watch list (u_group_watch_list)'. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// Add All Email Recipients to Watch List</span>
<span class="kd">var</span> <span class="nx">wList</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">watch_list</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">gList</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">u_group_watch_list</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">rarray</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">recipients_array</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">instanceEmail</span> <span class="o">=</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">getProperty</span><span class="p">(</span><span class="s1">&#39;glide.email.user&#39;</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">rarray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">recipient</span> <span class="o">=</span> <span class="nx">rarray</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
  <span class="c1">//Check to see if this is a group address...and if so add to the group watch list </span>
  <span class="kd">var</span> <span class="nx">grp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;sys_user_group&#39;</span><span class="p">);</span>
  <span class="nx">grp</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="nx">recipient</span><span class="p">);</span>
  <span class="nx">grp</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">grp</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span> 
    <span class="k">if</span><span class="p">(</span><span class="nx">gList</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">gList</span> <span class="o">=</span> <span class="p">(</span><span class="nx">gList</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">grp</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">gList</span> <span class="o">=</span> <span class="nx">grp</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
    <span class="c1">//It&#39;s not a group address...so check to see if it&#39;s a user</span>
    <span class="kd">var</span> <span class="nx">gr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;sys_user&#39;</span><span class="p">);</span>
    <span class="nx">gr</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="nx">recipient</span><span class="p">);</span>
    <span class="nx">gr</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">gr</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
      <span class="c1">// It&#39;s a user </span>
      <span class="k">if</span><span class="p">(</span><span class="nx">wList</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">wList</span> <span class="o">=</span> <span class="p">(</span><span class="nx">wList</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">gr</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">wList</span> <span class="o">=</span> <span class="nx">gr</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">//It&#39;s not a user either...so just add the address to the list...except instance email address </span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">recipient</span> <span class="o">!=</span> <span class="nx">instanceEmail</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">wList</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">wList</span> <span class="o">=</span> <span class="p">(</span><span class="nx">wList</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">recipient</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">wList</span> <span class="o">=</span> <span class="nx">recipient</span><span class="p">;</span>
        <span class="p">}</span>     
      <span class="p">}</span>
    <span class="p">}</span>   
    
  <span class="p">}</span>

<span class="p">}</span>

<span class="nx">current</span><span class="p">.</span><span class="nx">watch_list</span> <span class="o">=</span> <span class="nx">wList</span><span class="p">;</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">u_group_watch_list</span> <span class="o">=</span> <span class="nx">gList</span><span class="p">;</span>
<span class="nx">current</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <tt>body</tt> and <tt>message</tt> fields on the Notification form were changed to <tt>body_html</tt>, <tt>body_text</tt>, <tt>message_html</tt>, and <tt>message_text</tt> in the Eureka release.</i>
</td></tr></table>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The following integration is not part of the supported platform.  The integration may require additional customization, typically performed by an experienced administrator or consultant, prior to operating correctly.</i>
</td></tr></table>
<p><br />
<b>Name:</b> Create New User Based on Notification 
</p><p><b>Type:</b> Inbound Email Action 
</p><p><b>Table:</b> 
</p><p><b>Description:</b> This rule takes an autogenerated email from the PeopleSoft application and create a user account that is tied to the new employee's manager. It will then fire an event that will be used to kickoff an email to the manager requesting new items for the user. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nx">Condition</span> <span class="nx">Script</span><span class="o">:</span> <span class="nx">email</span><span class="p">.</span><span class="nx">subject</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;HR New Hire Notification&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>

  <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;New User request has been received...parsing email&quot;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">newUser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;sys_user&#39;</span><span class="p">);</span>

<span class="nx">newUser</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">user_password</span> <span class="o">=</span> <span class="s2">&quot;password&quot;</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">password_needs_reset</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">first_name</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">firstname</span><span class="p">;</span> 
<span class="nx">newUser</span><span class="p">.</span><span class="nx">last_name</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">lastname</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">employee_number</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">employeenumber</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">phone</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">phonenumber</span><span class="p">;</span> 
<span class="nx">newUser</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">jobtitle</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">u_action</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">action</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">u_action_date</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">actiondate</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">u_position</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span> 
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_location</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">location</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_street</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">street</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_city</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">city</span><span class="p">;</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_state</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span> 
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_zip</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">zip</span><span class="p">;</span> 

<span class="p">}</span>
</pre></div>
<p><br /><b>Convert the Supervisor ID into a manager</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">managerid</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;sys_user&quot;</span><span class="p">);</span>

<span class="nx">manager</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s2">&quot;employee_number&quot;</span><span class="p">,</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">supervisor_id</span><span class="p">);</span> <span class="nx">manager</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span> <span class="k">if</span><span class="p">(</span><span class="nx">manager</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> 

  <span class="nx">managerid</span> <span class="o">=</span> <span class="nx">manager</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>
 

<span class="nx">newUser</span><span class="p">.</span><span class="nx">manager</span> <span class="o">=</span> <span class="nx">managerid</span><span class="p">;</span> 

<span class="c1">//Check to see if the department exists...if it does exist, set newUser.department to it and if not, create the department. </span>

  <span class="kd">var</span> <span class="nx">dept</span><span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;cmn_department&quot;</span><span class="p">);</span>
  <span class="nx">dept</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">department</span><span class="p">);</span>

<span class="nx">dept</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span> <span class="k">if</span><span class="p">(</span><span class="nx">dept</span><span class="p">.</span><span class="nx">next</span><span class="p">()){</span> 

  <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Department found...writing to new user record&quot;</span><span class="p">);</span>
  <span class="nx">newUser</span><span class="p">.</span><span class="nx">department</span> <span class="o">=</span> <span class="nx">dept</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span><span class="p">{</span> 

  <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Department not found...inserting new department&quot;</span><span class="p">);</span>
  <span class="nx">dept</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
<span class="nx">dept</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">department</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">department</span> <span class="o">=</span> <span class="nx">dept</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>

<span class="p">}</span> <span class="nx">newUser</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;New User request parsing has been completed...adding user&quot;</span><span class="p">);</span>
</pre></div>
<p><br /><br /><b>Fire event that will kick off an email notification</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre> <span class="nx">gs</span><span class="p">.</span><span class="nx">eventQueue</span><span class="p">(</span><span class="s2">&quot;hr.new.hire.creation&quot;</span><span class="p">,</span> <span class="nx">newUser</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <tt>body</tt> and <tt>message</tt> fields on the Notification form were changed to <tt>body_html</tt>, <tt>body_text</tt>, <tt>message_html</tt>, and <tt>message_text</tt> in the Eureka release.</i>
</td></tr></table>
<p><br />
</p><p><b>Name:</b> Create User and Notify Manager and Location's Market Owner 
</p><p><b>Type:</b> Inbound Email Action 
</p><p><b>Table:</b> 
</p><p><b>Description:</b>  
</p><p><b>Parameters:</b> 
</p>
<b>Script:</b> <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;New User request has been received...parsing email&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">newUser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;sys_user&#39;</span><span class="p">);</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">user_password</span> <span class="o">=</span> <span class="s2">&quot;password&quot;</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">password_needs_reset</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">first_name</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">firstname</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">last_name</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">lastname</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">employee_number</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">employeenumber</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">phone</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">phonenumber</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">jobtitle</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_action</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">action</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_action_date</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">actiondate</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_position</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_location</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">location</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_street</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">street</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_city</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">city</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_state</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">u_user_zip</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">zip</span><span class="p">;</span>

 <span class="c1">//Convert the Supervisor ID into a manager</span>
<span class="kd">var</span> <span class="nx">managerid</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;sys_user&quot;</span><span class="p">);</span>
<span class="nx">manager</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s2">&quot;employee_number&quot;</span><span class="p">,</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">supervisor_id</span><span class="p">);</span>
<span class="nx">manager</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nx">manager</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span>
    <span class="nx">managerid</span> <span class="o">=</span> <span class="nx">manager</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>
    <span class="nx">newUser</span><span class="p">.</span><span class="nx">manager</span> <span class="o">=</span> <span class="nx">managerid</span><span class="p">;</span>

 <span class="c1">//Check to see if the department exists...</span>
<span class="c1">// if it does exist, set newUser.department to it...</span>
<span class="c1">// if not, create the department.</span>
<span class="kd">var</span> <span class="nx">dept</span><span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;cmn_department&quot;</span><span class="p">);</span>
<span class="nx">dept</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">department</span><span class="p">);</span>
<span class="nx">dept</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nx">dept</span><span class="p">.</span><span class="nx">next</span><span class="p">()){</span>
    <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Department found...writing to new user record&quot;</span><span class="p">);</span>
    <span class="nx">newUser</span><span class="p">.</span><span class="nx">department</span> <span class="o">=</span> <span class="nx">dept</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>
<span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Department not found...inserting new department&quot;</span><span class="p">);</span>
    <span class="nx">dept</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
    <span class="nx">dept</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_html</span><span class="p">.</span><span class="nx">department</span><span class="p">;</span>
    <span class="nx">newUser</span><span class="p">.</span><span class="nx">department</span> <span class="o">=</span> <span class="nx">dept</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
  <span class="p">}</span>
<span class="kd">var</span> <span class="nx">loc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;cmn_location&quot;</span><span class="p">);</span> 
<span class="nx">loc</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">city</span><span class="p">);</span>
<span class="nx">loc</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nx">loc</span><span class="p">.</span><span class="nx">next</span><span class="p">()){</span>
    <span class="kd">var</span> <span class="nx">emailto</span> <span class="o">=</span> <span class="nx">loc</span><span class="p">.</span><span class="nx">u_market</span><span class="p">.</span><span class="nx">u_email_to</span><span class="p">;</span>
    <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Market found...setting emailto to &quot;</span> <span class="o">+</span> <span class="nx">loc</span><span class="p">.</span><span class="nx">u_market</span><span class="p">.</span><span class="nx">u_email_to</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span><span class="p">{</span>
    <span class="kd">var</span> <span class="nx">emailto</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Market not found for new hire with ID#&quot;</span> <span class="o">+</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">employeenumber</span><span class="p">);</span>
<span class="p">}</span>

 <span class="c1">//Insert completed user record</span>
<span class="nx">newUser</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;New User request parsing has been completed...adding user&quot;</span><span class="p">);</span>
<span class="c1">//Fire event that will kick off an email notification to the supervisor</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">eventQueue</span><span class="p">(</span><span class="s2">&quot;hr.new.hire.creation&quot;</span><span class="p">,</span> <span class="nx">newUser</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nx">emailto</span> <span class="o">==</span> <span class="kc">null</span><span class="p">){</span>
   <span class="c1">//If the market could not be determined then fire event to notify admin to update record</span>
    <span class="nx">gs</span><span class="p">.</span><span class="nx">eventQueue</span><span class="p">(</span><span class="s2">&quot;hr.new.hire.error&quot;</span><span class="p">,</span> <span class="nx">newUser</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
<span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
   <span class="c1">//If found</span>
   <span class="c1">//Fire event that will send new hire notifications to distribution lists</span>
    <span class="nx">gs</span><span class="p">.</span><span class="nx">eventQueue</span><span class="p">(</span><span class="s2">&quot;hr.new.hire.notification&quot;</span><span class="p">,</span> <span class="nx">newUser</span><span class="p">,</span> <span class="nx">emailto</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
  <span class="p">}</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>This functionality can also be accomplished without scripting using the <tt>glide.pop3.ignore_subjects</tt> <a href="index.php%3Ftitle=Email_Properties.html" title="Email Properties">email property</a> to ignore system-generated email.</i>
</td></tr></table>
<p><br />
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <tt>body</tt> and <tt>message</tt> fields on the Notification form were changed to <tt>body_html</tt>, <tt>body_text</tt>, <tt>message_html</tt>, and <tt>message_text</tt> in the Eureka release.</i>
</td></tr></table>
<p><br />
<b>Name:</b> Prevent Ticket Creation Based on Phrase 
</p><p><b>Type:</b> Inbound Email Action 
</p><p><b>Table:</b> 
</p><p><b>Description:</b> Out-of-the-box, ServiceNow checks for specific common "out of office" prefixes at the start of the subject line of an inbound email. If it finds one, indicating that an inbound email is an auto-reply from a user's email server, an incident will not be automatically created. 
<br />
You can modify the default "Create Incident" Inbound Email Action to check for a specific phrase that will also prevent incident creation. For example, you may want emails with "out of the office" <i>anywhere</i> in the subject line to be ignored by the system. To do this, <a href="index.php%3Ftitle=Navigation.html" title="Navigation" class="mw-redirect">navigate</a> to <b>System Policy</b> &gt; <b>Inbound Email Actions</b> and open the "Create Incident" one. Add the following to the beginning: 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">skipmsg</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">subject</span><span class="o">&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">!=</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">subject</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">subject</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">subject</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;out of the office&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
   <span class="nx">skipmsg</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

<span class="p">}</span> 

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">skipmsg</span><span class="p">)</span> <span class="p">{</span>

<span class="p">}</span> 

<span class="p">}</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <tt>body</tt> and <tt>message</tt> fields on the Notification form were changed to <tt>body_html</tt>, <tt>body_text</tt>, <tt>message_html</tt>, and <tt>message_text</tt> in the Eureka release.</i>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id="Overview"><span class="mw-headline-number">1</span> Overview</span></h2>
<p>It is possible to reprocess emails that were received by your instance. A UI action named "Reprocess Email" puts a button on the email form: 
</p><p><br /><a href="index.php%3Ftitle=File:ReprocessEmail1.png.html" class="image"><img alt="ReprocessEmail1.png" src="images/d/da/ReprocessEmail1.png" width="734" height="307" /></a> 
</p><p><br />The script and condition are duplicated below for easy cutting and pasting. This UI action gives you a button when you open an email (in System Logs --&gt; Email) that has a type of "received" or "received-ignored". It will create an event that will reprocess that incoming email through the Inbound Email Actions. 
</p><p><br /> 
</p>
<hr />
<p><b>Condition</b>: 
</p>
<pre>current.type == 'received' || current.type == 'received-ignored'</pre>
<p><br /> <b>Script</b>: 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">evt</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;sysevent&#39;</span><span class="p">);</span>
<span class="nx">evt</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
<span class="nx">evt</span><span class="p">.</span><span class="nx">process_on</span> <span class="o">=</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">nowDateTime</span><span class="p">();</span>
<span class="nx">evt</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;email.read&quot;</span><span class="p">;</span>
<span class="nx">evt</span><span class="p">.</span><span class="nx">parm1</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sys_id</span><span class="p">;</span>
<span class="nx">evt</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">addInfoMessage</span><span class="p">(</span><span class="s1">&#39;event created to reprocess email &quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">subject</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
</pre></div>
<h2><span class="mw-headline" id="Reprocess_Multiple_Received_Emails"><span class="mw-headline-number">2</span> Reprocess Multiple Received Emails</span></h2>
<p>A similar "Reprocess received emails" UI action gives a list choice option at the bottom of the email list, which can be used to reprocess multiple emails at once. 
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>This article applies to Fuji and earlier releases. For more current information, see <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="https://docs.servicenow.com/bundle/jakarta-servicenow-platform/page/script/useful-scripts/topic/p_UsefulScripts.html">Useful Scripts</a> at <a target="_blank" rel="nofollow noreferrer noopener" class="external free" href="http://docs.servicenow.com">http://docs.servicenow.com</a></i>
<p><b>The ServiceNow Wiki is no longer being updated. Visit <a target="_blank" rel="nofollow noreferrer noopener" class="external free" href="http://docs.servicenow.com">http://docs.servicenow.com</a> for the latest product documentation.</b>
</p>
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <tt>body</tt> and <tt>message</tt> fields on the Notification form were changed to <tt>body_html</tt>, <tt>body_text</tt>, <tt>message_html</tt>, and <tt>message_text</tt> in the Eureka release.</i>
</td></tr></table>
<p><br />
<b>Name:</b> Respond to Approval with Yes or No 
</p><p><b>Type:</b> Inbound Email Action 
</p><p><b>Table:</b> 
</p><p><b>Description:</b> The following <b>Inbound Email Action</b> lets approvers reply with a simple "yes" or "no" answer to their approval email notifications. Create a new <b>Inbound Email Action</b> where Type = Reply, Event name = email.read, Target table = sysapproval_approver: 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="k">if</span> <span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">getTableName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;sysapproval_approver&quot;</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">approver</span> <span class="o">==</span> <span class="nx">email</span><span class="p">.</span><span class="nx">from_sys_id</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">current</span><span class="p">.</span><span class="nx">comments</span> <span class="o">=</span> <span class="s2">&quot;reply from: &quot;</span> <span class="o">+</span> <span class="nx">email</span><span class="p">.</span><span class="nx">from</span> <span class="o">+</span> <span class="s2">&quot;\n\n&quot;</span> <span class="o">+</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_text</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">state</span><span class="o">&amp;</span><span class="nx">nbsp</span><span class="p">;</span><span class="o">!=</span> <span class="kc">undefined</span><span class="p">)</span>
       <span class="nx">current</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_text</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">body_text</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;yes&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
       <span class="nx">current</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span> <span class="s2">&quot;approved&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">body_text</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;no&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
       <span class="nx">current</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span> <span class="s2">&quot;rejected&quot;</span><span class="p">;</span>

     <span class="nx">current</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
     <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Approval for task (&quot;</span><span class="o">+</span><span class="nx">current</span><span class="p">.</span><span class="nx">sysapproval</span><span class="p">.</span><span class="nx">getDisplayValue</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;)</span>
<span class="s2">     rejected because user sending email( &quot;</span><span class="o">+</span><span class="nx">email</span><span class="p">.</span><span class="nx">from</span><span class="o">+</span><span class="s2">&quot;) does not match the</span>
<span class="s2">     approver (&quot;</span><span class="o">+</span><span class="nx">current</span><span class="p">.</span><span class="nx">approver</span><span class="p">.</span><span class="nx">getDisplayValue</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<table cellspacing="5" cellpadding="5" class="FCK&#95;_ShowTableBorders" style="border: 1px solid rgb(153, 153, 5); margin-top: 0.5em; margin-bottom: 0.5em; vertical-align: top; width: 70%; background-color: rgb(245, 245, 245);">

<tr>
<td> <div class="floatleft"><a href="index.php%3Ftitle=File:Caution-diamond.png.html" class="image" title="As-is functionality"><img alt="As-is functionality" src="images/thumb/4/4f/Caution-diamond.png/25px-Caution-diamond.png" width="25" height="25" srcset="/images/thumb/4/4f/Caution-diamond.png/38px-Caution-diamond.png 1.5x, /images/thumb/4/4f/Caution-diamond.png/50px-Caution-diamond.png 2x" /></a></div>
</td>
<td width="100%"> <b>Caution: </b>The customization described here was developed for use in specific ServiceNow instances, and is not supported by ServiceNow Customer Support. This method is provided as-is and should be tested thoroughly before implementation. Post all questions and comments regarding this customization to our community <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://community.service-now.com">forum</a>.
</td></tr></table>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <tt>body</tt> and <tt>message</tt> fields on the Notification form were changed to <tt>body_html</tt>, <tt>body_text</tt>, <tt>message_html</tt>, and <tt>message_text</tt> in the Eureka release.</i>
</td></tr></table>
<p><br />
</p><p><b>Name:</b> Set Specific Value in Task 
</p><p><b>Type:</b> Inbound Email Action 
</p><p><b>Table:</b> 
</p><p><b>Description:</b> This inbound email action sets a specific value in task from an email alias. 
</p><p><b>Parameters:</b> 
</p><p><b>Script:</b> 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">emailTo</span><span class="o">=</span><span class="nx">email</span><span class="p">.</span><span class="nx">to</span><span class="p">;</span>

<span class="nx">emailTo</span><span class="o">=</span><span class="nx">emailTo</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span> <span class="k">if</span> <span class="p">((</span><span class="nx">emailTo</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;password@service-now.com&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span> 

 <span class="nx">current</span><span class="p">.</span><span class="nx">assignment_group</span><span class="p">.</span><span class="nx">setDisplayValue</span><span class="p">(</span><span class="s2">&quot;Password&quot;</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>

<!-- 
NewPP limit report
Cached time: 20171202162231
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.349 seconds
Real time usage: 3.358 seconds
Preprocessor visited node count: 211/1000000
Preprocessor generated node count: 570/1000000
Post‐expand include size: 23940/2097152 bytes
Template argument size: 4609/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00% 3121.862      1 - -total
 36.98% 1154.364      1 - Create_New_User_Based_on_Notification
 12.21%  381.160      1 - Create_User_and_Notify_Manager_and_Location's_Market_Owner
 11.81%  368.575      1 - Reprocess_Received_Emails
 11.22%  350.146      1 - Add_All_Email_Recipients_to_Watch_List
 10.52%  328.409      1 - Respond_to_Approval_with_Yes_or_No
 10.15%  316.939      1 - Prevent_Ticket_Creation_Based_on_Phrase
  6.67%  208.155      1 - Set_Specific_Value_in_Task_from_Email
  0.60%   18.618      6 - Template:Script
  0.37%   11.488     11 - Template:Note
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:6118-0!*!0!1!*!5!* and timestamp 20171202162228 and revision id 250973
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php%3Ftitle=Useful_Inbound_Email_Scripts&amp;oldid=250973.html">http://wiki.servicenow.com/index.php?title=Useful_Inbound_Email_Scripts&amp;oldid=250973</a>"</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="index.php%3Ftitle=Special:Categories.html" title="Special:Categories">Categories</a>: <ul><li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Useful+Scripts.html" title="Category:Useful Scripts">Useful Scripts</a></li><li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Inbound+Email+Scripts.html" title="Category:Inbound Email Scripts">Inbound Email Scripts</a></li></ul></div><br /><hr /><a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Contents</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Script.html" title="Category:Script">Script</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Useful+Scripts.html" title="Category:Useful Scripts">Useful Scripts</a><br />
<a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Contents</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Script.html" title="Category:Script">Script</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Useful+Scripts.html" title="Category:Useful Scripts">Useful Scripts</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Inbound+Email+Scripts.html" title="Category:Inbound Email Scripts">Inbound Email Scripts</a></div>					<!-- end content -->
					<div id='mw-data-after-content'>
	<div id="rating_6118"><div class="voting-title">Was this article helpful?</div><div class="voting-box"><div class="vote-up " data-vote-id="6118" data-vote-the-vote="5" data-vote-id="6118" data-vote-action="5" data-vote-rating="5.00" data-vote-voted="0" id="rating_6118_5"><span>Yes, I found what I needed</span></div><div class="vote-down " data-vote-id="6118" data-vote-the-vote="1" data-vote-id="6118" data-vote-action="5" data-vote-rating="5.00" data-vote-voted="0" id="rating_6118_1"><span>No, I need more assistance</span></div></div></div>
</div>
					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
					<div id="p-cactions" class="portlet" role="navigation">
			<h5>Views</h5>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php%3Ftitle=Useful_Inbound_Email_Scripts.html" title="View the content page [c]" accesskey="c">Page</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h5>Personal tools</h5>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="index.php%3Ftitle=Special:CreateAccount&amp;returnto=Useful+Inbound+Email+Scripts&amp;returntoquery=printable%253Dyes.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="index.php%3Ftitle=Special:UserLogin&amp;returnto=Useful+Inbound+Email+Scripts&amp;returntoquery=printable%253Dyes.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-" role="navigation">
		<h3></h3>
		<div class='pBody'>
			<div class="portlet">
<h5><span class="mw-headline" id="Categories">Categories</span></h5>
<div class="pBody">
<div class="sidebarcat">
<ul><li><a href="index.php%3Ftitle=Get_Started.html" title="Get Started">Get Started</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Use+ServiceNow&amp;oldid=0.html" title="Use ServiceNow">Use</a></li>
<li><a href="index.php%3Ftitle=Administer_ServiceNow.html" title="Administer ServiceNow">Administer</a></li>
<li><a href="index.php%3Ftitle=Script_in_ServiceNow.html" title="Script in ServiceNow">Script</a></li>
<li><a href="index.php%3Ftitle=Build.html" title="Build">Build</a></li>
<li><a href="index.php%3Ftitle=Deliver_ServiceNow.html" title="Deliver ServiceNow">Deliver</a></li>
<li><a href="index.php%3Ftitle=Integration_Overview.html" title="Integration Overview">Integrate</a></li>
<li><a href="index.php%3Ftitle=Release_Notes.html" title="Release Notes">Release Notes</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Customer+Support&amp;oldid=0.html" title="Customer Support">Customer Support</a></li>
<li><a href="index.php%3Ftitle=Books.html" title="Books">Books</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Video+Tutorials&amp;oldid=0.html" title="Video Tutorials">Video Tutorials</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://express.servicenow.com/support/">ServiceNow Express</a></li></ul>
</div>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Resources">Resources</span></h5>
<div class="pBody">
<ul><li><a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Site Map &#8211; Tree View</a><br /></li>
<li><a href="index.php%3Ftitle=Special:RecentChanges.html" title="Special:RecentChanges">Recent Changes</a><br /></li>
<li><a href="index.php%3Ftitle=Glossary_of_Terms.html" title="Glossary of Terms">Glossary</a><br /></li>
<li><a href="index.php%3Ftitle=Help:Getting_Started_on_the_ServiceNow_Wiki.html" title="Help:Getting Started on the ServiceNow Wiki">Wiki Help</a></li></ul>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Print">Print</span></h5>
<div class="pBody">
<ul><li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book&amp;bookcmd=book_creator.html">Create a Book</a></li>
<li><a href="index.php%3Ftitle=Help:Books.html" title="Help:Books">Book Help</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book%252Frender_article%252F&amp;arttitle=Useful_Inbound_Email_Scripts.html">Download Page as PDF</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Useful_Inbound_Email_Scripts&amp;printable=yes.html">Printable Version</a></li></ul>
</div>
</div>
		</div>
		</div>
		<div class="generated-sidebar portlet" id="p-coll-print_export" role="navigation">
		<h3>Print/export</h3>
		<div class='pBody'>
							<ul>
											<li id="coll-book_creator_disable"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Useful+Inbound+Email+Scripts.html">Disable book creator</a></li>
											<li id="coll-download-as-rl"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=render_article&amp;arttitle=Useful+Inbound+Email+Scripts&amp;returnto=Useful+Inbound+Email+Scripts&amp;oldid=250973&amp;writer=rl.html">Download as PDF</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://wiki.servicenow.com/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search ServiceNow Wiki [f]" accesskey="f" id="searchInput"/>
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton"/>&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Toolbox</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="index.php%3Ftitle=Special:WhatLinksHere%252FUseful_Inbound_Email_Scripts.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here?</a></li>
											<li id="t-recentchangeslinked"><a href="http://wiki.servicenow.com/index.php?title=Special:RecentChangesLinked/Useful_Inbound_Email_Scripts" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="index.php%3Ftitle=Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-permalink"><a href="index.php%3Ftitle=Useful_Inbound_Email_Scripts&amp;oldid=250973.html" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="index.php%3Ftitle=Useful_Inbound_Email_Scripts&amp;action=info.html" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified 18:57, 12 September 2017.</li>
									<li id="privacy"><a href="index.php%3Ftitle=ServiceNow_Wiki:Privacy_policy.html" title="ServiceNow Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="index.php%3Ftitle=ServiceNow_Wiki:About.html" title="ServiceNow Wiki:About">About ServiceNow Wiki</a></li>
									<li id="disclaimer"><a href="index.php%3Ftitle=ServiceNow_Wiki:General_disclaimer.html" title="ServiceNow Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["ext.treeandmenu","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.collection.bookcreator"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":1336});});</script></body></html>
