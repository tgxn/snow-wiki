<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8"/>
<title>Scripting Outbound SOAP - Versions Prior to Fuji - ServiceNow Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji","wgTitle":"Scripting Outbound SOAP - Versions Prior to Fuji","wgCurRevisionId":241583,"wgRevisionId":241583,"wgArticleId":23981,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Outbound Web Services"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji","wgRelevantArticleId":23981,"wgRequestId":"3dafdc0a276e53d71c6c3c1a","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":20,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup","ext.voteNY"]);});</script>
<link rel="stylesheet" href="http://wiki.servicenow.com/load.php?debug=false&amp;lang=en&amp;modules=ext.pygments%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook"/>
<!--[if IE 6]><link rel="stylesheet" href="/skins/MonoBook/IE60Fixes.css?303" media="screen"/><![endif]--><!--[if IE 7]><link rel="stylesheet" href="/skins/MonoBook/IE70Fixes.css?303" media="screen"/><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.27.3"/>
<meta name="robots" content="index,follow,noarchive"/>
<meta name="copyright" content="ServiceNow"/>
<meta http-equiv="content-language" content="en"/>
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<meta name="modified" content="20150131003553"/>
<meta name="canonical" content="//wiki.servicenow.com/index.php?title=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji"/>
<meta name="author" content="ServiceNow"/>
<meta name="twitter:card" content="@NOWsupport"/>
<meta name="twitter:title" content="Scripting Outbound SOAP - Versions Prior to Fuji"/>
<meta name="twitter:creator" content="@NOWsupport"/>
<meta name="twitter:domain" content="servicenow.com"/>
<meta name="keywords" content="Outbound Web Services"/>
<meta name="category" content="Outbound Web Services"/>
<link rel="shortcut icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="ServiceNow Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php%3Faction=rsd"/>
<link rel="alternate" type="application/atom+xml" title="ServiceNow Wiki Atom feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=atom.html"/>
<script type="text/javascript">window.tamBaseUrl='/extensions/TreeAndMenu'</script>

<script type="text/javascript" src="extensions/TreeAndMenu/dtree.js"></script>

<link rel="canonical" href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html" />

	<meta property="og:title" content="ServiceNow Wiki:Scripting Outbound SOAP - Versions Prior to Fuji"/>

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ServiceNow Wiki"/>

	<meta property="modified" content="20150131003553"/>

	<meta property="article:published_time" content="20150131003553"/>

	<meta property="article:modified_time" content="20150131003553"/>

	<meta property="article:author" content="ServiceNow"/>

	<meta property="article:tag" content="Outbound Web Services"/>

	<meta property="og:url" content="//wiki.servicenow.com/index.php?title=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji"/>

</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji rootpage-Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji skin-monobook action-view">
<div id="header">
	<div id="snc_top_toolbar" >
	<ul class="inline" id="sites">
		<li><a href="index.html">Wiki home</a></li>
		<li><a href="http://community.servicenow.com">Community</a></li>
		<li><a href="http://www.servicenow.com/services/training-and-certification.html">Training</a></li>
		<li><a href="https://www.servicenow.com/support.html">Support home</a></li>
		<li><a href="http://www.servicenow.com">Company home</a></li>
		<li><a href="http://info.servicenow.com/demonow/">Demo</a></li>
	</ul>

<!-- Start Adobe analytics staging -->
<script src="http://assets.adobedtm.com/43c21e31f00ba1c49c16c9c6a5acf67ef1e8dfa8/satelliteLib-c41330e93f48feef745e6ecb4b425db9d5da2dea.js"></script>

<!--Begin Google analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29210697-1']);
  _gaq.push(['_setDomainName', 'servicenow.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  _gaq.push(['_trackPageLoadTime']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- End Google analytics, begin other analytics -->

<!--<script type="text/javascript" language="javascript">llactid=11051</script>
<script type="text/javascript" language="javascript" src="https://trackalyzer.com/trackalyze_secure.js"></script>
-->
<!--End analytics-->

	</div>
</div>
<div id="snc_toolbar" >
	<a href="index.html">
	<img src="https://wiki.service-now.com/images/CustomWikiLogoFixed.png" height="64px">
	</a>
<div id="googleSearchBox"> <!--Google Search box -->
<div id='cse-search-form' style='width: 100%;'>Loading</div>
<script src='http://www.google.com/jsapi' type='text/javascript'></script>


<script type='text/javascript'>

google.load('search', '1', {language: 'en', style: google.loader.themes.V2_DEFAULT, callback:loadCSE});

window.onhashchange = function() {
	var url = window.location.href;
	if(url.indexOf("gsc.q") == -1) //call only when not browsing search results.
	{
		resetUI();
	}
}

function resetUI() {
	//reset UI to standard layout. Hide search, restore page content/controls.
	var cactions = document.getElementById('p-cactions');
	var cont = document.getElementById('content');
	var sr = document.getElementById('cse');

	cactions.style.display = 'block';
	sr.style.display = 'none';
	cont.style.display = 'block';
};

function onSubmit() {
	//hide page elements when searching.
	var cactions = document.getElementById('p-cactions');
	cactions.style.display = 'none';
	var sr = document.getElementById('cse');
	sr.style.display = 'block';
	var cont = document.getElementById('content');
	cont.style.display = 'none';
};

function loadCSE() {
	var customSearchOptions = {};
	var orderByOptions = {};
	orderByOptions['keys'] = [{label: 'Relevance', key: ''} , {label: 'Date', key: 'date'}];
	customSearchOptions['enableOrderBy'] = true;
	customSearchOptions['orderByOptions'] = orderByOptions;

	var customSearchControl = new google.search.CustomSearchControl('005409823165138974380:bltnnmgfoek', customSearchOptions);
	customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
	customSearchControl.setSearchCompleteCallback(this,onSubmit);//set onSubmit script to run when searching

	var options = new google.search.DrawOptions();
	options.setSearchFormRoot('cse-search-form');
	options.setAutoComplete(true);
	customSearchControl.draw('cse', options);
	var historyStarted = customSearchControl.startHistoryManagement();
	if(historyStarted) customSearchControl.setLinkTarget(google.search.Search.LINK_TARGET_SELF);
};

</script>

</div> <!--end Google search box-->
</div>

<div id="globalWrapper">
		<div id="column-content">
			<div id="cse"></div>
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div class="collection-creatorbox"><img src="extensions/Collection/images/Open_book.png%3F9" alt="" width="80" height="45" class="collection-creatorbox-book" /><div class="collection-creatorbox-row"><div><a href="index.php%3Ftitle=Help:Books.html" title="Show help about creating books" rel="nofollow"><img src="extensions/Collection/images/silk-help.png" alt="" width="16" height="16" />&#160;Help</a></div><span class="collection-creatorbox-title">Book creator</span> (<a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji.html" title="Stop using the book creator" rel="nofollow">disable</a>)</div><div id="coll-book_creator_box" class="collection-creatorbox-row"><a href="http://wiki.servicenow.com/index.php?title=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0" title="Remove the current wiki page from your book" id="coll-remove_article" rel="nofollow" onclick="collectionCall('RemoveArticle', ['addarticle', wgNamespaceNumber, wgTitle, &quot;0&quot;]); return false;"><img src="extensions/Collection/images/silk-remove.png" alt="" width="16" height="16" />&#160;Remove this page from your book</a><a href="index.php%3Ftitle=Special:Book%252Fload_collection%252F&amp;colltitle=Book:Introduction_to_ServiceNow_Part_1.html" title="Click to edit/download/order your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-book_open.png" alt="" width="16" height="16" />&#160;Show book (440 pages)</a><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=suggest.html" title="Show suggestions based on the pages in your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-wand.png" alt="" width="16" height="16" style="vertical-align: text-bottom" />&#160;Suggest pages</a></div></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Scripting Outbound SOAP - Versions Prior to Fuji</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From ServiceNow Wiki</div>
					<div id="contentSub"><!-- Text for discussion pages-->
<a href="index.html" title="Main Page">Home</a> &gt; <a href="index.php%3Ftitle=Integration_Overview.html" title="Integration Overview">Integrate</a> &gt; <a href="index.php%3Ftitle=Web_Services.html" title="Web Services">Web Services</a> &gt; Scripting Outbound SOAP - Versions Prior to Fuji</div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#column-one">navigation</a>, <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="noprint">
<table class="topicbox">

<tr>
<th> <a href="index.php%3Ftitle=Web_Services.html" title="Web Services">Web Services</a>
</th></tr>
<tr>
<td>  <div class='dtree' id='5a2436a6be230t'></div><script type="text/javascript">window.tamOnload_tam5a2436a6be230t=[];tree = new dTree('tam5a2436a6be230t');
                                               for (i in tree.icon) tree.icon[i] = '/extensions/TreeAndMenu/'+tree.icon[i];
                                               tree.config.useLines = false;
                                               tree.add(0,-1,'');
                                               tam5a2436a6be230t = tree;
                                               tam5a2436a6be230t.add(1, 0, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=REST_API\&quot;" title=\"REST API\">Inbound REST</a>');

tam5a2436a6be230t.add(2, 1, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Getting_Started_with_REST\&quot;" title=\"Getting Started with REST\">Getting Started with REST</a>');
tam5a2436a6be230t.add(3, 1, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Table_API\&quot;" title=\"Table API\">Table API</a>');
tam5a2436a6be230t.add(4, 1, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Import_Set_API\&quot;" title=\"Import Set API\">Import Set API</a>');
tam5a2436a6be230t.add(5, 1, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Aggregate_API\&quot;" title=\"Aggregate API\">Aggregate API</a>');
tam5a2436a6be230t.add(6, 1, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Aggregate_API_Examples\&quot;" title=\"Aggregate API Examples\">Aggregate API Examples</a>');
tam5a2436a6be230t.add(7, 1, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=REST_API_Explorer\&quot;" title=\"REST API Explorer\">REST API Explorer</a>');
tam5a2436a6be230t.add(8, 0, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=SOAP_Web_Service\&quot;" title=\"SOAP Web Service\">Inbound SOAP</a>');
tam5a2436a6be230t.add(9, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=SOAP_Direct_Web_Service_API\&quot;" title=\"SOAP Direct Web Service API\">Direct SOAP API</a>');
tam5a2436a6be230t.add(10, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Inbound_SOAP_Web_Service_Security\&quot;" title=\"Inbound SOAP Web Service Security\">Inbound SOAP Security</a>');
tam5a2436a6be230t.add(11, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Inserting_Related_Records_Using_SOAP\&quot;" title=\"Inserting Related Records Using SOAP\">Inserting Related Records</a>');
tam5a2436a6be230t.add(12, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=AttachmentCreator_SOAP_Web_Service\&quot;" title=\"AttachmentCreator SOAP Web Service\">Attachment Creator Web Service</a>');
tam5a2436a6be230t.add(13, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=ECC_Queue_Retry_Policy\&quot;" title=\"ECC Queue Retry Policy\">ECC Queue Retry Policy</a>');
tam5a2436a6be230t.add(14, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=SOAP_Session_Management_and_Reporting\&quot;" title=\"SOAP Session Management and Reporting\">SOAP Session Management and Reporting</a>');
tam5a2436a6be230t.add(15, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Long-Running_SOAP_Request_Support\&quot;" title=\"Long-Running SOAP Request Support\">Long-Running SOAP Request Support</a>');
tam5a2436a6be230t.add(16, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Creating_a_Static_WSDL\&quot;" title=\"Creating a Static WSDL\">Creating a Static WSDL</a>');
tam5a2436a6be230t.add(17, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Web_Services_Integrations_Best_Practices\&quot;" title=\"Web Services Integrations Best Practices\">Web Services Integrations Best Practices</a>');
tam5a2436a6be230t.add(18, 8, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API\&quot;" title=\"Perl API\">Perl API</a>');
tam5a2436a6be230t.add(19, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_ServiceNow\&quot;" title=\"Perl API ServiceNow\">Perl ServiceNow Module</a>');
tam5a2436a6be230t.add(20, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_GlideRecord\&quot;" title=\"Perl API GlideRecord\">GlideRecord</a>');
tam5a2436a6be230t.add(21, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Task\&quot;" title=\"Perl API Task\">Task</a>');
tam5a2436a6be230t.add(22, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Incident\&quot;" title=\"Perl API Incident\">Incident</a>');
tam5a2436a6be230t.add(23, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Problem\&quot;" title=\"Perl API Problem\">Problem</a>');
tam5a2436a6be230t.add(24, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Change\&quot;" title=\"Perl API Change\">Change</a>');
tam5a2436a6be230t.add(25, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Request\&quot;" title=\"Perl API Request\">Request</a>');
tam5a2436a6be230t.add(26, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_RequestedItem\&quot;" title=\"Perl API RequestedItem\">RequestedItem</a>');
tam5a2436a6be230t.add(27, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_SC_Task\&quot;" title=\"Perl API SC Task\">SC_Task</a>');
tam5a2436a6be230t.add(28, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Ticket\&quot;" title=\"Perl API Ticket\">Ticket</a>');
tam5a2436a6be230t.add(29, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Approval\&quot;" title=\"Perl API Approval\">Approval</a>');
tam5a2436a6be230t.add(30, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Dictionary\&quot;" title=\"Perl API Dictionary\">Dictionary</a>');
tam5a2436a6be230t.add(31, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Configuration\&quot;" title=\"Perl API Configuration\">Configuration</a>');
tam5a2436a6be230t.add(32, 18, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_API_Attachment\&quot;" title=\"Perl API Attachment\">Attachment</a>');
tam5a2436a6be230t.add(33, 0, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=ODBC_Driver\&quot;" title=\"ODBC Driver\">ODBC Driver</a>');
tam5a2436a6be230t.add(34, 33, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Getting_Started_with_ODBC\&quot;" title=\"Getting Started with ODBC\">ODBC Quick Start Guide</a>');
tam5a2436a6be230t.add(35, 33, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Installing_the_ODBC_Driver\&quot;" title=\"Installing the ODBC Driver\">Installing the Driver</a>');
tam5a2436a6be230t.add(36, 33, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Configuring_the_ODBC_Driver\&quot;" title=\"Configuring the ODBC Driver\">Configuring the Driver</a>');
tam5a2436a6be230t.add(37, 33, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Testing_the_ODBC_Driver\&quot;" title=\"Testing the ODBC Driver\">Testing the Driver</a>');
tam5a2436a6be230t.add(38, 33, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Using_the_ODBC_Driver\&quot;" title=\"Using the ODBC Driver\">Using the Driver</a>');
tam5a2436a6be230t.add(39, 33, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=ODBC_Best_Practices\&quot;" title=\"ODBC Best Practices\">ODBC Best Practices</a>');
tam5a2436a6be230t.add(40, 33, 'ODBC Client Configuration');
tam5a2436a6be230t.add(41, 40, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=HTTP_Client_Connection_Management\&quot;" title=\"HTTP Client Connection Management\">HTTP Client Connection Management</a>');
tam5a2436a6be230t.add(42, 40, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Using_Interactive_SQL_With_ODBC\&quot;" title=\"Using Interactive SQL With ODBC\">Running Interactive SQL (ODBC)</a>');
tam5a2436a6be230t.add(43, 40, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Using_the_ODBC_Driver_in_Excel_2010\&quot;" title=\"Using the ODBC Driver in Excel 2010\" class=\"mw-redirect\">Using the ODBC Driver in Excel 2010</a>');
tam5a2436a6be230t.add(44, 40, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Using_the_ODBC_Driver_in_Crystal_Reports_2008\&quot;" title=\"Using the ODBC Driver in Crystal Reports 2008\" class=\"mw-redirect\">Using the ODBC Driver in Crystal Reports 2008</a>');
tam5a2436a6be230t.add(45, 40, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Using_ODBC_Driver_in_SQL_Server_2008\&quot;" title=\"Using ODBC Driver in SQL Server 2008\" class=\"mw-redirect\">Using ODBC Driver in SQL Server 2008</a>');
tam5a2436a6be230t.add(46, 0, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Direct_Web_Services\&quot;" title=\"Direct Web Services\">Additional Direct Web Services</a>');
tam5a2436a6be230t.add(47, 46, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=CSV_Web_Service\&quot;" title=\"CSV Web Service\">CSV</a> ');
tam5a2436a6be230t.add(48, 46, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=EXCEL_Web_Service\&quot;" title=\"EXCEL Web Service\">EXCEL</a>');
tam5a2436a6be230t.add(49, 46, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=JSONv2_Web_Service\&quot;" title=\"JSONv2 Web Service\">JSONv2</a>');
tam5a2436a6be230t.add(50, 46, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=PDF_Web_Service\&quot;" title=\"PDF Web Service\">PDF</a>');
tam5a2436a6be230t.add(51, 46, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=XML_Web_Service\&quot;" title=\"XML Web Service\">XML</a>');
tam5a2436a6be230t.add(52, 46, 'RSS ');
tam5a2436a6be230t.add(53, 52, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=RSS_Feed_Generator\&quot;" title=\"RSS Feed Generator\">RSS Feed Generator</a> ');
tam5a2436a6be230t.add(54, 52, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=RSS_Feed_Reader\&quot;" title=\"RSS Feed Reader\">RSS Feed Reader</a>');
tam5a2436a6be230t.add(55, 0, 'Inbound Examples');
tam5a2436a6be230t.add(56, 55, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Java_Apache_Axis2_Web_Services_Client_Examples\&quot;" title=\"Java Apache Axis2 Web Services Client Examples\">Java Apache Axis2 Client</a>');
tam5a2436a6be230t.add(57, 55, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Microsoft_.NET_Web_Services_Client_Examples\&quot;" title=\"Microsoft .NET Web Services Client Examples\">Microsoft .NET Client</a>');
tam5a2436a6be230t.add(58, 55, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Perl_Web_Services_Client_Examples\&quot;" title=\"Perl Web Services Client Examples\">Perl Client</a>');
tam5a2436a6be230t.add(59, 55, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Python_Web_Services_Client_Examples\&quot;" title=\"Python Web Services Client Examples\">Python Client</a>');
tam5a2436a6be230t.add(60, 55, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Retrieving_A_Large_Number_Of_Records_Using_SOAP\&quot;" title=\"Retrieving A Large Number Of Records Using SOAP\">Retrieving A Large Number Of Records</a>');
tam5a2436a6be230t.add(61, 55, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Web_Services_C_Sharp_.NET_End_to_End_Tutorial\&quot;" title=\"Web Services C Sharp .NET End to End Tutorial\">C Sharp .NET End to End</a>');
tam5a2436a6be230t.add(62, 55, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Scripted_Web_Service_Tutorial\&quot;" title=\"Scripted Web Service Tutorial\">Scripted Web Service</a>');
tam5a2436a6be230t.add(63, 0, 'Outbound Web Services');
tam5a2436a6be230t.add(64, 63, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Outbound_REST_Web_Service\&quot;" title=\"Outbound REST Web Service\">Outbound REST</a>');
tam5a2436a6be230t.add(65, 63, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Outbound_SOAP_Web_Service\&quot;" title=\"Outbound SOAP Web Service\">Outbound SOAP</a>');
tam5a2436a6be230t.add(66, 63, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Outbound_Web_Services_Mutual_Authentication\&quot;" title=\"Outbound Web Services Mutual Authentication\">Outbound Mutual Authentication</a>');
tam5a2436a6be230t.add(67, 63, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Scripting_Outbound_REST\&quot;" title=\"Scripting Outbound REST\">Scripting Outbound REST</a>');
tam5a2436a6be230t.add(68, 63, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Scripting_Outbound_SOAP\&quot;" title=\"Scripting Outbound SOAP\">Scripting Outbound SOAP</a>');
tam5a2436a6be230t.add(69, 63, '<strong class=\"selflink\">Scripting Outbound SOAP Prior to Fuji</strong>');
tam5a2436a6be230t.add(70, 63, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Outbound_REST_Web_Service_-_Versions_Prior_to_Fuji\&quot;" title=\"Outbound REST Web Service - Versions Prior to Fuji\">Outbound REST Prior to Fuji</a>');
tam5a2436a6be230t.add(71, 63, 'Outbound APIs');
tam5a2436a6be230t.add(72, 71, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=RESTMessageV2_API\&quot;" title=\"RESTMessageV2 API\">RESTMessage</a>');
tam5a2436a6be230t.add(73, 71, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=RESTResponseV2_API\&quot;" title=\"RESTResponseV2 API\">RESTResponse</a>');
tam5a2436a6be230t.add(74, 71, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=SOAPMessageV2_API\&quot;" title=\"SOAPMessageV2 API\">SOAPMessage</a>');
tam5a2436a6be230t.add(75, 71, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=SOAPResponseV2_API\&quot;" title=\"SOAPResponseV2 API\">SOAPResponse</a>');
tam5a2436a6be230t.add(76, 0, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Direct_Web_Services\&quot;" title=\"Direct Web Services\">Direct Web Services</a>');
tam5a2436a6be230t.add(77, 0, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Web_Service_Import_Sets\&quot;" title=\"Web Service Import Sets\">Web Service Import Sets</a>');
tam5a2436a6be230t.add(78, 0, '<a href="http://wiki.servicenow.com/\&quot;/index.php?title=Scripted_Web_Services\&quot;" title=\"Scripted Web Services\">Scripted Web Services</a>');

                                               document.getElementById('5a2436a6be230t').innerHTML = tam5a2436a6be230t.toString();
                                               
                                               for(i in window.tamOnload_tam5a2436a6be230t) { window.tamOnload_tam5a2436a6be230t[i](); }</script>


<br />

</td></tr></table>
</div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Sending_SOAP_Message_via_the_MID_Server"><span class="tocnumber">2</span> <span class="toctext">Sending SOAP Message via the MID Server</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Getting_the_Response_in_a_Synchronous_Web_Service_Call"><span class="tocnumber">3</span> <span class="toctext">Getting the Response in a Synchronous Web Service Call</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Sending_Ad-Hoc_SOAP_Requests"><span class="tocnumber">4</span> <span class="toctext">Sending Ad-Hoc SOAP Requests</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Using_SOAPEnvelope"><span class="tocnumber">4.1</span> <span class="toctext">Using SOAPEnvelope</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Constructor"><span class="tocnumber">4.1.1</span> <span class="toctext">Constructor</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Document_namespaces"><span class="tocnumber">4.1.2</span> <span class="toctext">Document namespaces</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#SOAP_Headers"><span class="tocnumber">4.1.3</span> <span class="toctext">SOAP Headers</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#SOAP_Body"><span class="tocnumber">4.1.4</span> <span class="toctext">SOAP Body</span></a>
<ul>
<li class="toclevel-4 tocsection-10"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Creating_a_Function_in_a_Body_Element"><span class="tocnumber">4.1.4.1</span> <span class="toctext">Creating a Function in a Body Element</span></a></li>
<li class="toclevel-4 tocsection-11"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Creating_an_XML_Document_in_a_Body_Element"><span class="tocnumber">4.1.4.2</span> <span class="toctext">Creating an XML Document in a Body Element</span></a></li>
<li class="toclevel-4 tocsection-12"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Setting_Element_Attributes"><span class="tocnumber">4.1.4.3</span> <span class="toctext">Setting Element Attributes</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-13"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#SOAPRequest"><span class="tocnumber">4.2</span> <span class="toctext">SOAPRequest</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#SOAPRequest_Constructor"><span class="tocnumber">4.2.1</span> <span class="toctext">SOAPRequest Constructor</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Overriding_Proxy_Configuration"><span class="tocnumber">4.2.2</span> <span class="toctext">Overriding Proxy Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html#Examples_Using_SOAPEnvelope_and_SOAPRequest"><span class="tocnumber">4.3</span> <span class="toctext">Examples Using SOAPEnvelope and SOAPRequest</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Overview"><span class="mw-headline-number">1</span> Overview</span></h1>
<p>You can send <a href="index.php%3Ftitle=Outbound_SOAP_Web_Service.html" title="Outbound SOAP Web Service">outbound SOAP messages</a> using JavaScript.
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The examples on this page use the version one SOAPMessage API which has been superseded by the <a href="index.php%3Ftitle=SOAPMessageV2_API.html" title="SOAPMessageV2 API">SOAPMessageV2 API</a> starting with the <a href="index.php%3Ftitle=Fuji_Release_Notes.html" title="Fuji Release Notes">Fuji release</a>. If your instance is on the Fuji release or newer, refer to <a href="index.php%3Ftitle=Scripting_Outbound_SOAP.html" title="Scripting Outbound SOAP">Scripting Outbound SOAP</a>.</i>
</td></tr></table>
<p><br />
</p>
<h1><span class="mw-headline" id="Sending_SOAP_Message_via_the_MID_Server"><span class="mw-headline-number">2</span> Sending SOAP Message via the MID Server</span></h1>
<p>In some situations, it is desirable to send the SOAP message through a <a href="index.php%3Ftitle=MID_Server_Plugin.html" title="MID Server Plugin" class="mw-redirect">MID Server</a> to reach an endpoint within a firewall or a sub-network that is unreachable from your ServiceNow instance. The following SOAPMessage methods provide this functionality. See <a href="index.php%3Ftitle=MID_Server_Installation.html" title="MID Server Installation">MID Server installation</a> to install a MID Server that you can use.
</p>
<table class="standard">

<tr>
<th> Method
</th>
<th> Description
</th></tr>
<tr>
<td> <b>setMIDServer(server name)</b>
</td>
<td> When set to a MID Server name, directs the SOAP message invocation via the MID Server.
</td></tr>
<tr>
<td> <b>getResponse(milliseconds)</b>
</td>
<td> Since the SOAP message posting via the MID Server is asynchronous, the <tt>getResponse</tt> API waits for the specified number of milliseconds before querying for the response in the ECC queue. By putting this call in a loop, you can implement a polling mechanism with a default failure threshold. See the following example.
</td></tr></table>
<p>This example uses the JavaScript API to invoke a temperature conversion web service via the <b>win2008server</b> MID Server. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPMessage</span><span class="p">(</span><span class="s1">&#39;TemperatureConvert&#39;</span><span class="p">,</span> <span class="s1">&#39;TempConvertSoap.FahrenheitToCelsius&#39;</span><span class="p">);</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">setMIDServer</span><span class="p">(</span><span class="s2">&quot;win2008server&quot;</span><span class="p">);</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">setParameter</span><span class="p">(</span><span class="s1">&#39;temperatureF&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">);</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">post</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">getResponse</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span><span class="nx">r</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;waiting ... &quot;</span> <span class="o">+</span> <span class="nx">k</span> <span class="o">+</span> <span class="s2">&quot; seconds&quot;</span><span class="p">);</span>
  <span class="nx">r</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">getResponse</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
  <span class="nx">k</span><span class="o">++</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">k</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">break</span><span class="p">;</span> <span class="c1">// service did not respond after 30 tries</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">getHttpHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">));</span>
</pre></div>
<p><br />
The following is the output of the example:
</p>
<pre>
*** Script: waiting ... 1 seconds
*** Script: waiting ... 2 seconds
*** Script: waiting ... 3 seconds
*** Script: waiting ... 4 seconds
*** Script: 37.7777777777778
*** Script: text/xml; charset=utf-8
</pre>
<p>After the instance receives the HTTP response, you can use the following methods to retrieve the HTTP headers:
</p>
<table cellspacing="0" cellpadding="2" border="1">

<tr>
<th> Method
</th>
<th> Description
</th></tr>
<tr>
<td> <b>getHttpHeaders()</b>
</td>
<td> Returns a JSON object that represents all headers included with the incoming HTTP response.
</td></tr>
<tr>
<td> <b>getHttpHeader(name) </b>
</td>
<td> Returns a specific HTTP header by name.
</td></tr></table>
<p>As an advanced configuration, create a business rule on the ecc_queue table to observe the response from the MID Server and process the SOAP response asynchronously.
</p>
<h1><span class="mw-headline" id="Getting_the_Response_in_a_Synchronous_Web_Service_Call"><span class="mw-headline-number">3</span> Getting the Response in a Synchronous Web Service Call</span></h1>
<p>When you use the ServiceNow web service consumer feature and choose to make synchronous web service calls to external web services, you can capture and handle data that is returned by that web service. For example, if you use one of the sample web services that comes with the ServiceNow SOAP Message module, you can see how to use the response data. This example uses the TemperatureConvert SOAP message.  When called by the ServiceNow instance, this web service returns a converted temperature value.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPMessage</span><span class="p">(</span><span class="s1">&#39;TemperatureConvert&#39;</span><span class="p">,</span> <span class="s1">&#39;TempConvertSoap.FahrenheitToCelsius&#39;</span><span class="p">);</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">setParameter</span><span class="p">(</span><span class="s1">&#39;temperatureF&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">post</span><span class="p">();</span>
</pre></div>
<p>This code calls the web service and issues 100 as the <tt>temperatureF</tt> parameter in the <tt>FahrenheitToCelsius</tt> function. This is a synchronous call, so it returns the SOAP response to the variable <tt>response</tt>. The response will look like this:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nt">&lt;soap:Envelope</span> <span class="na">xmlns:soap=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
        <span class="na">xmlns:xsd=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;soap:Body&gt;</span>
        <span class="nt">&lt;FahrenheitToCelsiusResponse</span> <span class="na">xmlns=</span><span class="s">&quot;http://tempuri.org/&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;FahrenheitToCelsiusResult&gt;</span>37.7777777777778<span class="nt">&lt;/FahrenheitToCelsiusResult&gt;</span>
        <span class="nt">&lt;/FahrenheitToCelsiusResponse&gt;</span>
    <span class="nt">&lt;/soap:Body&gt;</span>
<span class="nt">&lt;/soap:Envelope&gt;</span>
</pre></div>
<p>Since the SOAP response is an XML string, convert it to an actual XML document so that you can use XPATH operations on it.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">xmldoc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLDocument</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
</pre></div>
<p>Now that it is converted to an XMLDocument, use XPATH to get the text for the element named <tt>FahrenheitToCelsiusResult</tt>.  
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">cel</span> <span class="o">=</span> <span class="nx">xmldoc</span><span class="p">.</span><span class="nx">getNodeText</span><span class="p">(</span><span class="s2">&quot;//FahrenheitToCelsiusResult&quot;</span><span class="p">);</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Celcius: &quot;</span> <span class="o">+</span> <span class="nx">cel</span><span class="p">);</span>
</pre></div>
<p>The resulting code prints out the value of 37.777778.
</p>
<h1><span class="mw-headline" id="Sending_Ad-Hoc_SOAP_Requests"><span class="mw-headline-number">4</span> Sending Ad-Hoc SOAP Requests</span></h1>
<p>You can construct an entire SOAP request through script, without using the <a href="index.php%3Ftitle=Outbound_SOAP_Web_Service.html" title="Outbound SOAP Web Service">outbound SOAP table</a>.
</p>
<h2><span class="mw-headline" id="Using_SOAPEnvelope"><span class="mw-headline-number">4.1</span> Using SOAPEnvelope</span></h2>
<p>A <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3schools.com/webservices/ws_soap_envelope.asp">SOAP envelope</a> is the the XML document used for communicating a soap request to an endpoint, usually a HTTP server processing these requests. 
</p><p>The SOAPEnvelope JavaScript class creates a SOAP envelope to be used for invoking an external service. 
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>Usage of these JavaScript classes requires knowledge of the resultant SOAP message format and service description to be invoked. The web service definition is usally described in the documentation for the web service provider, or described in a published <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3.org/TR/2003/WD-wsdl12-20030303/">WSDL</a>.</i>
</td></tr></table>
<p><br />
</p>
<h3><span class="mw-headline" id="Constructor"><span class="mw-headline-number">4.1.1</span> Constructor</span></h3>
<p>The SOAPEnvelope constructor creates a new SOAPEnvelope object and can optionally take arguments for the body element name and <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3.org/TR/REC-xml-names/">XML namespace</a>. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// construct a SOAPEnvelope without any arguments</span>
<span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>

<span class="c1">// construct a SOAPEnvelope where the body element is called &quot;alert&quot; with a namespace of &quot;http://company.com/alert&quot;</span>
<span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">(</span><span class="s2">&quot;alert&quot;</span><span class="p">,</span> <span class="s2">&quot;http://company.com/alert&quot;</span><span class="p">);</span>
</pre></div>
<h3><span class="mw-headline" id="Document_namespaces"><span class="mw-headline-number">4.1.2</span> Document namespaces</span></h3>
<p><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3.org/TR/REC-xml-names/">XML namespaces</a> are used to prefix XML element names so that there is no collision. By default, the following document level namespaces are defined for the SOAPEnvelope object. 
</p>
<pre>
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
</pre> 
<p>To add more you can use the <tt>createNameSpace(name, value)</tt> function. You may add as many document namespaces as you need. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// create a new namespace for the SOAPEnvelope document</span>
<span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">createNameSpace</span><span class="p">(</span><span class="s2">&quot;xmlns:tns&quot;</span><span class="p">,</span> <span class="s2">&quot;http://www.service-now.com/mynamespace&quot;</span><span class="p">);</span>
</pre></div>
<h3><span class="mw-headline" id="SOAP_Headers"><span class="mw-headline-number">4.1.3</span> SOAP Headers</span></h3>
<p>A <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3schools.com/webservices/ws_soap_header.asp">SOAP header</a> is usually used to send session related data, such as login credentials, to the target service. SOAP headers have the parent XML element of <tt>SOAP-ENV:Header</tt>. If you need to send headers in a SOAP request, you can use the <tt>createHeaderElement(name, value, attrName, attrValue)</tt> function. You can create as many SOAP headers as you need. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// create a header element for your SOAP envelope to contain a User ID</span>
<span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">createHeaderElement</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;david.loo&quot;</span><span class="p">,</span> <span class="s2">&quot;soap:mustUnderstand&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">);</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">createHeaderElement</span><span class="p">(</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;xxxx&quot;</span><span class="p">);</span>
</pre></div>
<h3><span class="mw-headline" id="SOAP_Body"><span class="mw-headline-number">4.1.4</span> SOAP Body</span></h3>
<p>A <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3schools.com/webservices/ws_soap_body.asp">SOAP body</a> element is the payload of the SOAP request, or the argument of the request, if your SOAP request is <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/">document literal</a>. The parent SOAP body element has the XML element name of <tt>SOAP-ENV:Body</tt>. You can create the SOAP body elements using the <tt>createBodyElement(name, value, attrName, attrValue)</tt> function. Using this function, you are only creating single level elements for your SOAP body element. You can create as many body elements as you need. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// create a body element for your SOAP envelope for &quot;alert&quot;</span>
<span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">createBodyElement</span><span class="p">(</span><span class="s2">&quot;alert&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="s2">&quot;xmlns&quot;</span><span class="p">,</span> <span class="s2">&quot;http://optional_name_space&quot;</span><span class="p">);</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">createBodyElement</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">);</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">createBodyElement</span><span class="p">(</span><span class="s2">&quot;notify&quot;</span><span class="p">,</span> <span class="s2">&quot;david.loo&quot;</span><span class="p">);</span>
</pre></div> 
<p>The preceding example results in the following document.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nt">&lt;SOAP-ENV:Envelope</span>
    <span class="na">xmlns:xsd=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:SOAP-ENC=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">SOAP-ENV:encodingStyle=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">xmlns:SOAP-ENV=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;SOAP-ENV:Body&gt;</span>
      <span class="nt">&lt;alert</span> <span class="na">xmlns=</span><span class="s">&quot;http://optional_name_space&quot;</span><span class="nt">&gt;</span>down<span class="nt">&lt;/alert&gt;</span>
      <span class="nt">&lt;priority&gt;</span>1<span class="nt">&lt;/priority&gt;</span>
      <span class="nt">&lt;notify&gt;</span>david.loo<span class="nt">&lt;/notify&gt;</span>
    <span class="nt">&lt;/SOAP-ENV:Body&gt;</span>
<span class="nt">&lt;/SOAP-ENV:Envelope&gt;</span>
</pre></div>
<h4><span class="mw-headline" id="Creating_a_Function_in_a_Body_Element"><span class="mw-headline-number">4.1.4.1</span> Creating a Function in a Body Element</span></h4>
<p>Often there is a need to create an <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/">RPC/Encoded</a> SOAPEnvelope that contains a function and its parameters. To create this style of SOAPEnvelope, you can use <tt>setFunctionName(name, namespace)</tt> and <tt>addFunctionParameter(name, value)</tt> to create function parameters. You can only set one function name, but you can create multiple arguments for the function. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">setFunctionName</span><span class="p">(</span><span class="s2">&quot;myFunc&quot;</span><span class="p">,</span> <span class="s2">&quot;http://my_name_space&quot;</span><span class="p">);</span> <span class="c1">// namespace is optional</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">addFunctionParameter</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;1234&quot;</span><span class="p">);</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">addFunctionParameter</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;abcd&quot;</span><span class="p">);</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">addFunctionParameter</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;333&quot;</span><span class="p">,</span> <span class="s2">&quot;xsd:long&quot;</span><span class="p">);</span> <span class="c1">// option to specify xsi type</span>
</pre></div>
<p>The preceding example results in the following SOAPEnvelope.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nt">&lt;SOAP-ENV:Envelope</span>
    <span class="na">xmlns:xsd=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:SOAP-ENC=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">SOAP-ENV:encodingStyle=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">xmlns:SOAP-ENV=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;SOAP-ENV:Body&gt;</span>
      <span class="nt">&lt;myFunc</span> <span class="na">xmlns=</span><span class="s">&quot;http://my_name_space&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;x</span> <span class="na">xsi:type=</span><span class="s">&quot;xsd:string&quot;</span><span class="nt">&gt;</span>1234<span class="nt">&lt;/x&gt;</span>
        <span class="nt">&lt;y</span> <span class="na">xsi:type=</span><span class="s">&quot;xsd:string&quot;</span><span class="nt">&gt;</span>abcd<span class="nt">&lt;/y&gt;</span>
        <span class="nt">&lt;z</span> <span class="na">xsi:type=</span><span class="s">&quot;xsd:long&quot;</span><span class="nt">&gt;</span>333<span class="nt">&lt;/z&gt;</span>
      <span class="nt">&lt;/myFunc&gt;</span>
    <span class="nt">&lt;/SOAP-ENV:Body&gt;</span>
<span class="nt">&lt;/SOAP-ENV:Envelope&gt;</span>
</pre></div>
<h4><span class="mw-headline" id="Creating_an_XML_Document_in_a_Body_Element"><span class="mw-headline-number">4.1.4.2</span> Creating an XML Document in a Body Element</span></h4>
<p>If there is a requirement to create multiple level XML elements in your SOAPEnvelope body element, for example a <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/">document literal</a> type of SOAP request, you can use the <tt>createBodyElement(name, value, attrName, attrValue)</tt> function in conjunction with the <tt>createElement(parent, name, value)</tt> function. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">alert</span> <span class="o">=</span> <span class="nx">envelope</span><span class="p">.</span><span class="nx">createBodyElement</span><span class="p">(</span><span class="s2">&quot;alert&quot;</span><span class="p">);</span> <span class="c1">// if value is not specified, then it becomes a parent element</span>
<span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">envelope</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">);</span> <span class="c1">// if type is not specified, then it becomes a parent element</span>
<span class="nx">envelope</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;server_down&quot;</span><span class="p">);</span>
</pre></div> 
<p>The preceding example results in the following SOAPEnvelope.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nt">&lt;SOAP-ENV:Envelope</span>
    <span class="na">xmlns:xsd=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:SOAP-ENC=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">SOAP-ENV:encodingStyle=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">xmlns:SOAP-ENV=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;SOAP-ENV:Body&gt;</span>
      <span class="nt">&lt;alert&gt;</span>
        <span class="nt">&lt;type&gt;</span>
          <span class="nt">&lt;name&gt;</span>server_down<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;/alert&gt;</span>
    <span class="nt">&lt;/SOAP-ENV:Body&gt;</span>
<span class="nt">&lt;/SOAP-ENV:Envelope&gt;</span>
</pre></div>
<h4><span class="mw-headline" id="Setting_Element_Attributes"><span class="mw-headline-number">4.1.4.3</span> Setting Element Attributes</span></h4>
<p>You can set attributes for any element in the SOAPEnvelope. For example, if you want to set an XML namespace to the body element, you can do the following. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">alert</span> <span class="o">=</span> <span class="nx">envelope</span><span class="p">.</span><span class="nx">createBodyElement</span><span class="p">(</span><span class="s2">&quot;alert&quot;</span><span class="p">);</span> <span class="c1">// if value is not specified, then it becomes a parent element</span>
<span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">envelope</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">);</span> <span class="c1">// if type is not specified, then it becomes a parent element</span>
<span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">envelope</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;server_down&quot;</span><span class="p">);</span>

<span class="nx">envelope</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">alert</span><span class="p">,</span> <span class="s2">&quot;xmlns&quot;</span><span class="p">,</span> <span class="s2">&quot;http://mynamespace&quot;</span><span class="p">);</span> <span class="c1">// set the default namespace for the alert element</span>
</pre></div> 
<p>The preceding example results in the following SOAPEnvelope.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nt">&lt;SOAP-ENV:Envelope</span>
    <span class="na">xmlns:xsd=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:SOAP-ENC=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">SOAP-ENV:encodingStyle=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
    <span class="na">xmlns:SOAP-ENV=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;SOAP-ENV:Body&gt;</span>
      <span class="nt">&lt;alert</span> <span class="na">xmlns=</span><span class="s">&quot;http://mynamespace&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;type&gt;</span>
          <span class="nt">&lt;name&gt;</span>server_down<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;/alert&gt;</span>
    <span class="nt">&lt;/SOAP-ENV:Body&gt;</span>
<span class="nt">&lt;/SOAP-ENV:Envelope&gt;</span>
</pre></div>
<h2><span class="mw-headline" id="SOAPRequest"><span class="mw-headline-number">4.2</span> SOAPRequest</span></h2>
<p>SOAPRequest synchronously invokes a SOAP service using a SOAPEnvelope as input. The SOAPRequest does an HTTP(S) POST to the specified endpoint URL, using the supplied SOAPEnvelope object to generate the POST document. Additionally, there is an object function to add the request to the ECC queue to be processed. 
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The <b>SOAPClient</b> business rule on the ecc_queue table executes the SOAPRequest call.  If the business rule is set as <b>async</b>, then the SOAP request will be posted asynchronously via a scheduled worker. If you change this rule to <b>async</b>, add <b>current.update()</b> at the end of the business rule so that the ECC queue record will be updated. By default the <b>SOAPClient</b> business rule runs in a <b>before</b> context.</i>
</td></tr></table>
<p><br />
</p>
<h3><span class="mw-headline" id="SOAPRequest_Constructor"><span class="mw-headline-number">4.2.1</span> SOAPRequest Constructor</span></h3>
<p>The constructor of the SOAPRequest object allows you to specify the endpoint of the SOAP request. Optionally, you may specify the user name and password to be used in <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3.org/Protocols/HTTP/1.0/draft-ietf-http-spec.html#BasicAA">HTTP basic auth</a> for the request. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPRequest</span><span class="p">(</span><span class="s2">&quot;http://something.com/something.asmx&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">);</span>
</pre></div> 
<p>The following example shows how to use the SOAPRequest object to post a request using a SOAPEnvelope object. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// create the SOAPEnvelope</span>
<span class="kd">var</span> <span class="nx">envelope</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="p">...</span>

<span class="c1">// post the SOAPEnvelope directly</span>
<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPRequest</span><span class="p">(</span><span class="s2">&quot;http://something.com/something.asmx&quot;</span><span class="p">);</span> <span class="c1">// specify the URL endpoint</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">setSoapAction</span><span class="p">(</span><span class="s2">&quot;Create&quot;</span><span class="p">);</span> <span class="c1">// optionally set the SOAPAction header</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">envelope</span><span class="p">);</span> <span class="c1">// post the envelope directly</span>

<span class="c1">// optionally you can post the message through the ECC queue SOAPClient business rule</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">envelope</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
<p>If a SOAP request is invoked via the ECC queue, the result can be parsed and returned using the following syntax.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="p">...</span>
<span class="c1">// this is a &quot;blocking&quot; read, it will wait for the ECC queue response</span>
<span class="kd">var</span> <span class="nx">price</span> <span class="o">=</span> <span class="nx">envelope</span><span class="p">.</span><span class="nx">getResponse</span><span class="p">(</span><span class="s2">&quot;//StockQuotes/Stock/Last&quot;</span><span class="p">);</span>
</pre></div>
<p>To get the result out of a synchronous call using the SOAPRequest object instead, call the <tt>getResponseDoc()</tt> function, which returns an XML document you can parse. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">envelope</span> <span class="p">...</span>
<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPRequest</span><span class="p">(...);</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">envelope</span><span class="p">);</span>
<span class="p">...</span>
<span class="kd">var</span> <span class="nx">xml_str</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">getResponseDoc</span><span class="p">();</span> <span class="c1">// returns a string representation of the XML response</span>
</pre></div> 
<p>Once you have the web service response as an XML string, you can instantiate an <a href="index.php%3Ftitle=XMLDocument_Script_Object.html" title="XMLDocument Script Object">XMLDocument</a> to parse the return value and extract useful data. 
</p><p>Additionally, calling the <tt>getHttpStatus()</tt> function will return to you the <a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">HTTP status code</a> of the request. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">envelope</span> <span class="p">...</span>
<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPRequest</span><span class="p">(...);</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">envelope</span><span class="p">);</span>
<span class="p">...</span>
<span class="kd">var</span> <span class="nx">status</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">getHttpStatus</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">)</span>
  <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;error &quot;</span> <span class="o">+</span> <span class="nx">status</span><span class="p">);</span>
</pre></div>
<h3><span class="mw-headline" id="Overriding_Proxy_Configuration"><span class="mw-headline-number">4.2.2</span> Overriding Proxy Configuration</span></h3>
<p>Additionally, you can override the properties programmatically using the following call.
</p>
<pre>request.setupProxy("proxy.company.com", 9100);
</pre> 
<p>If you want to invoke the SOAP request without submitting it through the global proxy settings set by the properties above, you can call the <tt>setupProxy(proxy)</tt> function with the argument of <b>unset</b>.
</p>
<pre>request.setupProxy("unset");
</pre>
<h2><span class="mw-headline" id="Examples_Using_SOAPEnvelope_and_SOAPRequest"><span class="mw-headline-number">4.3</span> Examples Using SOAPEnvelope and SOAPRequest</span></h2>
<p>This example script sends a direct SOAP request to get a stock quote for a given stock symbol.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">env</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
<span class="nx">env</span><span class="p">.</span><span class="nx">setFunctionName</span><span class="p">(</span><span class="s2">&quot;GetQuote&quot;</span><span class="p">,</span> <span class="s2">&quot;http://www.webserviceX.NET/&quot;</span><span class="p">);</span>
<span class="nx">env</span><span class="p">.</span><span class="nx">addFunctionParameter</span><span class="p">(</span><span class="s2">&quot;symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;IBM&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPRequest</span><span class="p">(</span><span class="s2">&quot;http://www.webservicex.net/stockquote.asmx&quot;</span><span class="p">);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">setSoapAction</span><span class="p">(</span><span class="s2">&quot;http://www.webserviceX.NET/GetQuote&quot;</span><span class="p">);</span>
<span class="nx">req</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">env</span><span class="p">);</span>
<span class="nx">gs</span><span class="p">.</span><span class="nx">print</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">getResponseDoc</span><span class="p">());</span> <span class="c1">// print out the whole response XML</span>
</pre></div> 
<p>The Get Stock Quote UI action on the core_company table sends the SOAP request using the ECC queue.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="kd">var</span> <span class="nx">soap</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPEnvelope</span><span class="p">();</span>
 <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">soap</span><span class="p">.</span><span class="nx">createBodyElement</span><span class="p">(</span><span class="s2">&quot;GetQuote&quot;</span><span class="p">);</span>
 <span class="nx">soap</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="s2">&quot;xmlns&quot;</span><span class="p">,</span><span class="s2">&quot;http://www.webserviceX.NET/&quot;</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">symbol</span> <span class="o">=</span> <span class="nx">soap</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">stock_symbol</span><span class="p">);</span>
 <span class="nx">soap</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">symbol</span><span class="p">,</span> <span class="s2">&quot;xsi:type&quot;</span><span class="p">,</span> <span class="s2">&quot;xsd:string&quot;</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SOAPRequest</span><span class="p">(</span><span class="s2">&quot;http://www.webservicex.net/stockquote.asmx&quot;</span><span class="p">);</span> 
 <span class="nx">request</span><span class="p">.</span><span class="nx">setSoapAction</span><span class="p">(</span><span class="s2">&quot;http://www.webserviceX.NET/GetQuote&quot;</span><span class="p">);</span>
 <span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">soap</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span> <span class="c1">// invoked via ECC Queue</span>
 <span class="kd">var</span> <span class="nx">price</span> <span class="o">=</span> <span class="nx">soap</span><span class="p">.</span><span class="nx">getResponse</span><span class="p">(</span><span class="s2">&quot;//StockQuotes/Stock/Last&quot;</span><span class="p">);</span> <span class="c1">// waits for ECC Queue response</span>
</pre></div> 
<p>This script creates an ECC queue record with the following content.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nt">&lt;SOAP-ENV:Envelope</span>
     <span class="na">xmlns:xsd=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
     <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
     <span class="na">xmlns:SOAP-ENC=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
     <span class="na">SOAP-ENV:encodingStyle=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>
     <span class="na">xmlns:SOAP-ENV=</span><span class="s">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;SOAP-ENV:Body&gt;</span>
       <span class="nt">&lt;GetQuote</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.webserviceX.NET/&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;symbol</span> <span class="na">xsi:type=</span><span class="s">&quot;xsd:string&quot;</span><span class="nt">&gt;</span>IBM<span class="nt">&lt;/symbol&gt;</span>
       <span class="nt">&lt;/GetQuote&gt;</span>
     <span class="nt">&lt;/SOAP-ENV:Body&gt;</span>
<span class="nt">&lt;/SOAP-ENV:Envelope&gt;</span>
</pre></div> 
<p>To process the response synchronously, add the following to the UI action: 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre> <span class="nx">current</span><span class="p">.</span><span class="nx">stock_price</span> <span class="o">=</span> <span class="nx">price</span><span class="p">;</span>
 <span class="nx">current</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
</pre></div> 
<p>Or you can create a business rule on the ecc_queue table to process the response asynchronously (see the <b>Process Get Stock Quote</b> business rule as an example).
</p>
<!-- 
NewPP limit report
Cached time: 20171203173854
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.372 seconds
Real time usage: 7.385 seconds
Preprocessor visited node count: 331/1000000
Preprocessor generated node count: 864/1000000
Post‐expand include size: 1881/2097152 bytes
Template argument size: 1058/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00% 4353.549      1 - -total
  2.20%   95.648      1 - Template:Web_Services
  1.96%   85.230      1 - Template:Topic
  0.18%    7.889      3 - Template:Note
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:23981-0!*!0!1!en!5!* and timestamp 20171203173846 and revision id 241583
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php%3Ftitle=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji&amp;oldid=241583.html">http://wiki.servicenow.com/index.php?title=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji&amp;oldid=241583</a>"</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="index.php%3Ftitle=Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Outbound+Web+Services.html" title="Category:Outbound Web Services">Outbound Web Services</a></li></ul></div><br /><hr /><a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Contents</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Integrate.html" title="Category:Integrate">Integrate</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Web+Services.html" title="Category:Web Services">Web Services</a> &gt; <a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_category&amp;cattitle=Outbound+Web+Services.html" title="Category:Outbound Web Services">Outbound Web Services</a></div>					<!-- end content -->
					<div id='mw-data-after-content'>
	<div id="rating_23981"><div class="voting-title">Was this article helpful?</div><div class="voting-box"><div class="vote-up " data-vote-id="23981" data-vote-the-vote="5" data-vote-id="23981" data-vote-action="5" data-vote-rating="0.00" data-vote-voted="0" id="rating_23981_5"><span>Yes, I found what I needed</span></div><div class="vote-down " data-vote-id="23981" data-vote-the-vote="1" data-vote-id="23981" data-vote-action="5" data-vote-rating="0.00" data-vote-voted="0" id="rating_23981_1"><span>No, I need more assistance</span></div></div></div>
</div>
					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
					<div id="p-cactions" class="portlet" role="navigation">
			<h5>Views</h5>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=0.html" title="View the content page [c]" accesskey="c">Page</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h5>Personal tools</h5>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="index.php%3Ftitle=Special:CreateAccount&amp;returnto=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji.html" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="index.php%3Ftitle=Special:UserLogin&amp;returnto=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji.html" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-" role="navigation">
		<h3></h3>
		<div class='pBody'>
			<div class="portlet">
<h5><span class="mw-headline" id="Categories">Categories</span></h5>
<div class="pBody">
<div class="sidebarcat">
<ul><li><a href="index.php%3Ftitle=Get_Started.html" title="Get Started">Get Started</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Use+ServiceNow&amp;oldid=0.html" title="Use ServiceNow">Use</a></li>
<li><a href="index.php%3Ftitle=Administer_ServiceNow.html" title="Administer ServiceNow">Administer</a></li>
<li><a href="index.php%3Ftitle=Script_in_ServiceNow.html" title="Script in ServiceNow">Script</a></li>
<li><a href="index.php%3Ftitle=Build.html" title="Build">Build</a></li>
<li><a href="index.php%3Ftitle=Deliver_ServiceNow.html" title="Deliver ServiceNow">Deliver</a></li>
<li><a href="index.php%3Ftitle=Integration_Overview.html" title="Integration Overview">Integrate</a></li>
<li><a href="index.php%3Ftitle=Release_Notes.html" title="Release Notes">Release Notes</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Customer+Support&amp;oldid=0.html" title="Customer Support">Customer Support</a></li>
<li><a href="index.php%3Ftitle=Books.html" title="Books">Books</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Video+Tutorials&amp;oldid=0.html" title="Video Tutorials">Video Tutorials</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://express.servicenow.com/support/">ServiceNow Express</a></li></ul>
</div>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Resources">Resources</span></h5>
<div class="pBody">
<ul><li><a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Site Map &#8211; Tree View</a><br /></li>
<li><a href="index.php%3Ftitle=Special:RecentChanges.html" title="Special:RecentChanges">Recent Changes</a><br /></li>
<li><a href="index.php%3Ftitle=Glossary_of_Terms.html" title="Glossary of Terms">Glossary</a><br /></li>
<li><a href="index.php%3Ftitle=Help:Getting_Started_on_the_ServiceNow_Wiki.html" title="Help:Getting Started on the ServiceNow Wiki">Wiki Help</a></li></ul>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Print">Print</span></h5>
<div class="pBody">
<ul><li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book&amp;bookcmd=book_creator.html">Create a Book</a></li>
<li><a href="index.php%3Ftitle=Help:Books.html" title="Help:Books">Book Help</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book%252Frender_article%252F&amp;arttitle=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji.html">Download Page as PDF</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji&amp;printable=yes.html">Printable Version</a></li></ul>
</div>
</div>
		</div>
		</div>
		<div class="generated-sidebar portlet" id="p-coll-print_export" role="navigation">
		<h3>Print/export</h3>
		<div class='pBody'>
							<ul>
											<li id="coll-book_creator_disable"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji.html">Disable book creator</a></li>
											<li id="coll-download-as-rl"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=render_article&amp;arttitle=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;returnto=Scripting+Outbound+SOAP+-+Versions+Prior+to+Fuji&amp;oldid=241583&amp;writer=rl.html">Download as PDF</a></li>
											<li id="t-print"><a href="index.php%3Ftitle=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji&amp;printable=yes.html" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://wiki.servicenow.com/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search ServiceNow Wiki [f]" accesskey="f" id="searchInput"/>
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton"/>&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Toolbox</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="index.php%3Ftitle=Special:WhatLinksHere%252FScripting_Outbound_SOAP_-_Versions_Prior_to_Fuji.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here?</a></li>
											<li id="t-recentchangeslinked"><a href="http://wiki.servicenow.com/index.php?title=Special:RecentChangesLinked/Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="index.php%3Ftitle=Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-permalink"><a href="index.php%3Ftitle=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji&amp;oldid=241583.html" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="index.php%3Ftitle=Scripting_Outbound_SOAP_-_Versions_Prior_to_Fuji&amp;action=info.html" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified 00:35, 31 January 2015.</li>
									<li id="privacy"><a href="index.php%3Ftitle=ServiceNow_Wiki:Privacy_policy.html" title="ServiceNow Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="index.php%3Ftitle=ServiceNow_Wiki:About.html" title="ServiceNow Wiki:About">About ServiceNow Wiki</a></li>
									<li id="disclaimer"><a href="index.php%3Ftitle=ServiceNow_Wiki:General_disclaimer.html" title="ServiceNow Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["ext.treeandmenu","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.collection.bookcreator"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":884});});</script></body></html>
