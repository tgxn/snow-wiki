<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8"/>
<title>Borland Starteam Integration - ServiceNow Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Borland_Starteam_Integration","wgTitle":"Borland Starteam Integration","wgCurRevisionId":196220,"wgRevisionId":196220,"wgArticleId":3934,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Borland_Starteam_Integration","wgRelevantArticleId":3934,"wgRequestId":"084cf2f96c00d8b5fc344a75","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":20,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup","ext.voteNY"]);});</script>
<link rel="stylesheet" href="http://wiki.servicenow.com/load.php?debug=false&amp;lang=en&amp;modules=ext.pygments%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook"/>
<!--[if IE 6]><link rel="stylesheet" href="/skins/MonoBook/IE60Fixes.css?303" media="screen"/><![endif]--><!--[if IE 7]><link rel="stylesheet" href="/skins/MonoBook/IE70Fixes.css?303" media="screen"/><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.27.3"/>
<meta name="robots" content="noindex,nofollow"/>
<meta name="robots" content="index,follow,noarchive"/>
<meta name="copyright" content="ServiceNow"/>
<meta http-equiv="content-language" content="en"/>
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<meta name="modified" content="20131115212233"/>
<meta name="canonical" content="//wiki.servicenow.com/index.php?title=Borland_Starteam_Integration"/>
<meta name="author" content="ServiceNow"/>
<meta name="twitter:card" content="@NOWsupport"/>
<meta name="twitter:title" content="Borland Starteam Integration"/>
<meta name="twitter:creator" content="@NOWsupport"/>
<meta name="twitter:domain" content="servicenow.com"/>
<link rel="shortcut icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="ServiceNow Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php%3Faction=rsd"/>
<link rel="alternate" type="application/atom+xml" title="ServiceNow Wiki Atom feed" href="index.php%3Ftitle=Special:RecentChanges&amp;feed=atom.html"/>
<script type="text/javascript">window.tamBaseUrl='/extensions/TreeAndMenu'</script>

<script type="text/javascript" src="extensions/TreeAndMenu/dtree.js"></script>

<link rel="canonical" href="index.php%3Ftitle=Borland_Starteam_Integration.html" />

	<meta property="og:title" content="ServiceNow Wiki:Borland Starteam Integration"/>

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ServiceNow Wiki"/>

	<meta property="modified" content="20131115212233"/>

	<meta property="article:published_time" content="20131115212233"/>

	<meta property="article:modified_time" content="20131115212233"/>

	<meta property="article:author" content="ServiceNow"/>

	<meta property="og:url" content="//wiki.servicenow.com/index.php?title=Borland_Starteam_Integration"/>

</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Borland_Starteam_Integration rootpage-Borland_Starteam_Integration skin-monobook action-view">
<div id="header">
	<div id="snc_top_toolbar" >
	<ul class="inline" id="sites">
		<li><a href="index.html">Wiki home</a></li>
		<li><a href="http://community.servicenow.com">Community</a></li>
		<li><a href="http://www.servicenow.com/services/training-and-certification.html">Training</a></li>
		<li><a href="https://www.servicenow.com/support.html">Support home</a></li>
		<li><a href="http://www.servicenow.com">Company home</a></li>
		<li><a href="http://info.servicenow.com/demonow/">Demo</a></li>
	</ul>

<!-- Start Adobe analytics staging -->
<script src="http://assets.adobedtm.com/43c21e31f00ba1c49c16c9c6a5acf67ef1e8dfa8/satelliteLib-c41330e93f48feef745e6ecb4b425db9d5da2dea.js"></script>

<!--Begin Google analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29210697-1']);
  _gaq.push(['_setDomainName', 'servicenow.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  _gaq.push(['_trackPageLoadTime']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- End Google analytics, begin other analytics -->

<!--<script type="text/javascript" language="javascript">llactid=11051</script>
<script type="text/javascript" language="javascript" src="https://trackalyzer.com/trackalyze_secure.js"></script>
-->
<!--End analytics-->

	</div>
</div>
<div id="snc_toolbar" >
	<a href="index.html">
	<img src="https://wiki.service-now.com/images/CustomWikiLogoFixed.png" height="64px">
	</a>
<div id="googleSearchBox"> <!--Google Search box -->
<div id='cse-search-form' style='width: 100%;'>Loading</div>
<script src='http://www.google.com/jsapi' type='text/javascript'></script>


<script type='text/javascript'>

google.load('search', '1', {language: 'en', style: google.loader.themes.V2_DEFAULT, callback:loadCSE});

window.onhashchange = function() {
	var url = window.location.href;
	if(url.indexOf("gsc.q") == -1) //call only when not browsing search results.
	{
		resetUI();
	}
}

function resetUI() {
	//reset UI to standard layout. Hide search, restore page content/controls.
	var cactions = document.getElementById('p-cactions');
	var cont = document.getElementById('content');
	var sr = document.getElementById('cse');

	cactions.style.display = 'block';
	sr.style.display = 'none';
	cont.style.display = 'block';
};

function onSubmit() {
	//hide page elements when searching.
	var cactions = document.getElementById('p-cactions');
	cactions.style.display = 'none';
	var sr = document.getElementById('cse');
	sr.style.display = 'block';
	var cont = document.getElementById('content');
	cont.style.display = 'none';
};

function loadCSE() {
	var customSearchOptions = {};
	var orderByOptions = {};
	orderByOptions['keys'] = [{label: 'Relevance', key: ''} , {label: 'Date', key: 'date'}];
	customSearchOptions['enableOrderBy'] = true;
	customSearchOptions['orderByOptions'] = orderByOptions;

	var customSearchControl = new google.search.CustomSearchControl('005409823165138974380:bltnnmgfoek', customSearchOptions);
	customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
	customSearchControl.setSearchCompleteCallback(this,onSubmit);//set onSubmit script to run when searching

	var options = new google.search.DrawOptions();
	options.setSearchFormRoot('cse-search-form');
	options.setAutoComplete(true);
	customSearchControl.draw('cse', options);
	var historyStarted = customSearchControl.startHistoryManagement();
	if(historyStarted) customSearchControl.setLinkTarget(google.search.Search.LINK_TARGET_SELF);
};

</script>

</div> <!--end Google search box-->
</div>

<div id="globalWrapper">
		<div id="column-content">
			<div id="cse"></div>
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div class="collection-creatorbox"><img src="extensions/Collection/images/Open_book.png%3F9" alt="" width="80" height="45" class="collection-creatorbox-book" /><div class="collection-creatorbox-row"><div><a href="index.php%3Ftitle=Help:Books.html" title="Show help about creating books" rel="nofollow"><img src="extensions/Collection/images/silk-help.png" alt="" width="16" height="16" />&#160;Help</a></div><span class="collection-creatorbox-title">Book creator</span> (<a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Borland+Starteam+Integration.html" title="Stop using the book creator" rel="nofollow">disable</a>)</div><div id="coll-book_creator_box" class="collection-creatorbox-row"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=add_article&amp;arttitle=Borland+Starteam+Integration&amp;oldid=0.html" title="Add the current wiki page to your book" id="coll-add_article" rel="nofollow" onclick="collectionCall('AddArticle', ['removearticle', wgNamespaceNumber, wgTitle, 0]); return false;"><img src="extensions/Collection/images/silk-add.png" alt="" width="16" height="16" />&#160;Add this page to your book</a><a href="index.php%3Ftitle=Special:Book%252Fload_collection%252F&amp;colltitle=Book:Introduction_to_ServiceNow_Part_1.html" title="Click to edit/download/order your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-book_open.png" alt="" width="16" height="16" />&#160;Show book (31 pages)</a><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=suggest.html" title="Show suggestions based on the pages in your book" rel="nofollow" class="collection-creatorbox-iconlink"><img src="extensions/Collection/images/silk-wand.png" alt="" width="16" height="16" style="vertical-align: text-bottom" />&#160;Suggest pages</a></div></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Borland Starteam Integration</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From ServiceNow Wiki</div>
					<div id="contentSub"><!-- Text for discussion pages-->
Borland Starteam Integration</div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#column-one">navigation</a>, <a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>The following integration is not part of the supported platform.  The integration may require additional customization, typically performed by an experienced administrator or consultant, prior to operating correctly.</i>
</td></tr></table>
<p><br />
</p>
<div class="noprint">
<table class="topicbox">

<tr>
<th> Other Integrations
</th></tr>
<tr>
<td>
<ul><li><strong class="selflink">Borland Starteam Integration</strong> </li>
<li><a href="index.php%3Ftitle=Building_a_Search_Provider_for_your_Instance.html" title="Building a Search Provider for your Instance">Building a Search Provider for your Instance</a> </li>
<li><a href="index.php%3Ftitle=Integrating_ServiceNow_with_your_Intranet.html" title="Integrating ServiceNow with your Intranet">Integrating ServiceNow with your Intranet</a> </li>
<li><a href="index.php%3Ftitle=JDBCProbe.html" title="JDBCProbe">Integrating Databases using JDBCProbe</a> </li>
<li><a href="index.php%3Ftitle=Syslog_Probe.html" title="Syslog Probe">Integrating Syslog Servers with Syslog Probe</a></li>
<li><a href="index.php%3Ftitle=Change_Management_Integration_with_Outlook.html" title="Change Management Integration with Outlook">Change Management Integration with Outlook</a> </li>
<li><a href="index.php%3Ftitle=Computer_Telephony_Integration_(CTI).html" title="Computer Telephony Integration (CTI)" class="mw-redirect">Computer Telephony Integration (CTI)</a> </li>
<li><a href="index.php%3Ftitle=HDI_Survey_Integration.html" title="HDI Survey Integration">HDI Survey</a> </li>
<li><a href="index.php%3Ftitle=Sendmail_Support.html" title="Sendmail Support">Integrating with Sendmail</a></li>
<li><a href="index.php%3Ftitle=MDSL_Integration.html" title="MDSL Integration">MDSL Telecom Expense Management</a></li></ul>
</td></tr></table>
</div>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#High_Level_Process_Review"><span class="tocnumber">2</span> <span class="toctext">High Level Process Review</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#Requirements"><span class="tocnumber">3</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#Setup"><span class="tocnumber">4</span> <span class="toctext">Setup</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#Starteam_SDK_Script"><span class="tocnumber">4.1</span> <span class="toctext">Starteam SDK Script</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#UI_Action_to_initiate_the_request"><span class="tocnumber">4.2</span> <span class="toctext">UI Action to initiate the request</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#Business_Rules_to_handle_response_from_Starteam"><span class="tocnumber">4.3</span> <span class="toctext">Business Rules to handle response from Starteam</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#Handling_Errors"><span class="tocnumber">4.4</span> <span class="toctext">Handling Errors</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html#Inbound_Email_Action_to_handle_closure"><span class="tocnumber">4.5</span> <span class="toctext">Inbound Email Action to handle closure</span></a></li>
</ul>
</li>
</ul>
</div>
 
<h2><span class="mw-headline" id="Overview"><span class="mw-headline-number">1</span> Overview</span></h2>
<p>This integration will allow you to create change requests in a Borland Starteam system from an incident in ServiceNow. There are parts of this integration that were designed for one particular customer, but the design can be tailored for configuration variances. This is also a good example of how to leverage a MID server to run just about any type of command in the customer environment. 
</p>
<h2><span class="mw-headline" id="High_Level_Process_Review"><span class="mw-headline-number">2</span> High Level Process Review</span></h2>
<ol><li>UI Action starts the process to create a change </li>
<li>Send a command to the MID Server </li>
<li>MID Server runs command using the Starteam SDK to access Starteam </li>
<li>MID Server returns the new change number from Starteam </li>
<li>Business rules populate the new change number in the incident </li>
<li>Once the change is completed in Starteam, an inbound email action closes the related incident</li></ol>
<h2><span class="mw-headline" id="Requirements"><span class="mw-headline-number">3</span> Requirements</span></h2>
<ul><li>MID Server </li>
<li>Borland Starteam Server </li>
<li>Borland Starteam COM SDK </li>
<li>Assignment groups are used to identify the Starteam project where the change request will be created. The UI Action script expects a new field on the group table called 'Starteam Project'. The project names on the groups must match the project names from Starteam. </li>
<li>The Starteam change number is stored in the incident, so you must also add a field called 'Starteam Change' on the incident table. </li>
<li>The business rule uses a custom event called 'starteam.error' which is linked to an email notification when there are errors returned from Starteam</li></ul>
<h2><span class="mw-headline" id="Setup"><span class="mw-headline-number">4</span> Setup</span></h2>
<h3><span class="mw-headline" id="Starteam_SDK_Script"><span class="mw-headline-number">4.1</span> Starteam SDK Script</span></h3>
The first step is to create the script that will be executed on the MID Server to create the change on the Starteam server. This script will reside on the MID Server. It takes in parameters from the command line and uses the Starteam COM SDK to create the change request. You will need to modify the Starteam server parameters in the script as well as any custom field handling. Once this is created you can test it's functionality by running it directly on the MID Server providing the necessary parameters. You should not proceed until this works locally. <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// create_cr.js - StarTeam SDK Application to Create Change Request</span>
<span class="c1">// 2008-03-01</span>
<span class="c1">// Created by ServiceNow as part of the initial deployment</span>
<span class="c1">// Most of this was inherited from the SDK Examples</span>
<span class="c1">//</span>
<span class="c1">// Input Parameters:</span>
<span class="c1">// All Command line parameters should be in the form:</span>
<span class="c1">// /project:&quot;&quot; /u_abstract:&quot;&quot; /number:&quot;&quot; /u_original_comments:&quot;&quot; /caller_id-name:&quot;&quot; /caller_id-phone:&quot;&quot; /caller_id-email:&quot;&quot;</span>
<span class="c1">// /u_original_assignment_group:&quot;&quot; /caller_id-department:&quot;&quot; /caller_id-company:&quot;&quot; /category:&quot;&quot; /subcategory:&quot;&quot; /u_topic:&quot;&quot;</span>
<span class="c1">// Values with spaces must be enclosed in quotes</span>
<span class="c1">//</span>
<span class="c1">// Return:</span>
<span class="c1">// Returns the new Change Request ID</span>
<span class="c1">//</span>
<span class="c1">//</span>
<span class="c1">// ----------------------------------------------------------------------------</span>


<span class="c1">//define the Starteam Server parameters</span>
<span class="kd">var</span> <span class="nx">g_strServer</span> <span class="o">=</span> <span class="s2">&quot;STARTEAM1&quot;</span><span class="p">;</span> <span class="c1">// Server TCP/IP address</span>
<span class="kd">var</span> <span class="nx">g_nPort</span> <span class="o">=</span> <span class="mi">49200</span><span class="p">;</span> <span class="c1">// Server port number</span>
<span class="kd">var</span> <span class="nx">g_strUser</span> <span class="o">=</span> <span class="s2">&quot;USERNAME&quot;</span><span class="p">;</span> <span class="c1">// Logon user name</span>
<span class="kd">var</span> <span class="nx">g_strPassword</span> <span class="o">=</span> <span class="s2">&quot;PASSWORD&quot;</span><span class="p">;</span> <span class="c1">// Logon password</span>

<span class="c1">//get the name of the Starteam project from the commandline parameters</span>
<span class="kd">var</span> <span class="nx">g_strProject</span> <span class="o">=</span> <span class="nx">getParameter</span><span class="p">(</span><span class="s2">&quot;project&quot;</span><span class="p">);</span> <span class="c1">// Project name</span>

<span class="kd">var</span> <span class="nx">complete</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span> <span class="c1">//track insert event completion</span>


<span class="c1">// Run it</span>
<span class="nx">main</span><span class="p">();</span>

<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Main program entry point.</span>
<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="kd">function</span> <span class="nx">main</span><span class="p">()</span>
<span class="p">{</span>

 <span class="c1">// Connect to the StarTeam server, and log on.</span>
 <span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">getServer</span><span class="p">();</span>

 <span class="c1">// Must enable MPX to receive events.</span>
 <span class="nx">server</span><span class="p">.</span><span class="nx">enableMPX</span><span class="p">();</span>

 <span class="kd">var</span> <span class="nx">project</span> <span class="o">=</span> <span class="nx">getProject</span><span class="p">(</span><span class="nx">server</span><span class="p">,</span> <span class="nx">g_strProject</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">project</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
 <span class="p">{</span>
 <span class="c1">// Run the app.</span>
 <span class="nx">run</span><span class="p">(</span><span class="nx">project</span><span class="p">.</span><span class="nx">DefaultView</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">else</span>
 <span class="p">{</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;No such project: \&quot;&quot;</span> <span class="o">+</span> <span class="nx">g_strProject</span> <span class="o">+</span> <span class="s2">&quot;\&quot;.&quot;</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="c1">// Disconnect from the server.</span>
 <span class="nx">server</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Creates a StarTeam server object, connects to the server, and logs in.</span>
<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="kd">function</span> <span class="nx">getServer</span><span class="p">()</span>
<span class="p">{</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;Connecting...&quot;</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;StarTeam.StServerFactory&quot;</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">.</span><span class="nx">Create</span><span class="p">(</span><span class="nx">g_strServer</span><span class="p">,</span> <span class="nx">g_nPort</span><span class="p">);</span>
 <span class="c1">// Optional; logOn() connects if necessary.</span>
 <span class="nx">server</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>

 <span class="c1">// Logon using specified user name and password.</span>
 <span class="nx">server</span><span class="p">.</span><span class="nx">logOn</span><span class="p">(</span><span class="nx">g_strUser</span><span class="p">,</span> <span class="nx">g_strPassword</span><span class="p">);</span>

 <span class="k">return</span><span class="p">(</span><span class="nx">server</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Finds the project.</span>
<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="kd">function</span> <span class="nx">getProject</span><span class="p">(</span><span class="nx">server</span><span class="p">,</span> <span class="nx">strName</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">ep</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Enumerator</span><span class="p">(</span><span class="nx">server</span><span class="p">.</span><span class="nx">Projects</span><span class="p">);</span> <span class="o">!</span><span class="nx">ep</span><span class="p">.</span><span class="nx">atEnd</span><span class="p">();</span> <span class="nx">ep</span><span class="p">.</span><span class="nx">moveNext</span><span class="p">())</span>
 <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">project</span> <span class="o">=</span> <span class="nx">ep</span><span class="p">.</span><span class="nx">item</span><span class="p">();</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">project</span><span class="p">.</span><span class="nx">Name</span> <span class="o">==</span> <span class="nx">strName</span><span class="p">)</span>
 <span class="p">{</span>
 <span class="k">return</span> <span class="nx">project</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>


<span class="kd">function</span> <span class="nx">run</span><span class="p">(</span><span class="nx">view</span><span class="p">)</span>
<span class="p">{</span>
 <span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">view</span><span class="p">.</span><span class="nx">Server</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">strType</span> <span class="o">=</span> <span class="nx">server</span><span class="p">.</span><span class="nx">TypeNames</span><span class="p">.</span><span class="nx">CHANGEREQUEST</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">server</span><span class="p">.</span><span class="nx">typeForName</span><span class="p">(</span><span class="nx">strType</span><span class="p">);</span>

 <span class="c1">// Create a new event source for ItemEvents of type ChangeRequest.</span>
 <span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="nx">view</span><span class="p">.</span><span class="nx">newItemEventSource</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>

 <span class="c1">// Attach our event handlers.</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">ConnectObject</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="s2">&quot;on_&quot;</span><span class="p">);</span>

 <span class="c1">// Create some ChangeRequests.</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;Adding CRs...&quot;</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;StarTeam.StChangeRequestFactory&quot;</span><span class="p">);</span>

 <span class="c1">//create the change request in the root folder</span>
 <span class="c1">//this could be modified to store in subfolders if needed</span>
 <span class="kd">var</span> <span class="nx">folder</span> <span class="o">=</span> <span class="nx">view</span><span class="p">.</span><span class="nx">RootFolder</span><span class="p">;</span>

 <span class="c1">//initialize the change request</span>
 <span class="kd">var</span> <span class="nx">CR</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">.</span><span class="nx">Create</span><span class="p">(</span><span class="nx">folder</span><span class="p">);</span>

 <span class="c1">//get parameter values from command line for standard fields</span>
 <span class="nx">CR</span><span class="p">.</span><span class="nx">Synopsis</span> <span class="o">=</span> <span class="nx">getParameter</span><span class="p">(</span><span class="s2">&quot;synopsis&quot;</span><span class="p">);</span> <span class="c1">//u_abstract</span>
 <span class="c1">//this is where the incident number goes</span>
 <span class="nx">CR</span><span class="p">.</span><span class="nx">ExternalReference</span> <span class="o">=</span> <span class="nx">getParameter</span><span class="p">(</span><span class="s2">&quot;ext_ref&quot;</span><span class="p">);</span> <span class="c1">//number</span>
 <span class="nx">CR</span><span class="p">.</span><span class="nx">Description</span> <span class="o">=</span> <span class="nx">getParameter</span><span class="p">(</span><span class="s2">&quot;desc&quot;</span><span class="p">);</span> <span class="c1">//u_original_comments</span>

 <span class="c1">//get parameters from command line for custom fields</span>
 <span class="c1">//CR.put(&#39;Starteam_FieldName&#39;, getParameter(&quot;commandLineParameterName&quot;)); </span>


 <span class="c1">//save the request</span>
 <span class="nx">CR</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>

 <span class="c1">// Wait for event to be received identifying insert complete</span>
 <span class="k">while</span> <span class="p">(</span><span class="nx">complete</span> <span class="o">!=</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Handles the Command Line Parameters</span>
<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="kd">function</span> <span class="nx">getParameter</span><span class="p">(</span><span class="nx">parmName</span><span class="p">)</span> 
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">WScript</span><span class="p">.</span><span class="nx">Arguments</span><span class="p">.</span><span class="nx">Named</span><span class="p">.</span><span class="nx">Exists</span><span class="p">(</span><span class="nx">parmName</span><span class="p">))</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nx">WScript</span><span class="p">.</span><span class="nx">Arguments</span><span class="p">.</span><span class="nx">Named</span><span class="p">(</span><span class="nx">parmName</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span>
 <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Our only event-handler.</span>
<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="kd">function</span> <span class="nx">on_itemAdded</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
<span class="p">{</span>
 <span class="c1">// Display a message, and count the events.</span>
 <span class="kd">var</span> <span class="nx">CR</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">NewItem</span><span class="p">;</span>

 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;Created Change Request&quot;</span><span class="p">);</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;ChangeRequest=&quot;</span> <span class="o">+</span> <span class="nx">CR</span><span class="p">.</span><span class="nb">Number</span> <span class="p">);</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;Incident=&quot;</span> <span class="o">+</span> <span class="nx">getParameter</span><span class="p">(</span><span class="s2">&quot;ext_ref&quot;</span><span class="p">));</span>
 <span class="nx">WScript</span><span class="p">.</span><span class="nx">Echo</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
 <span class="nx">complete</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div> 
<h3><span class="mw-headline" id="UI_Action_to_initiate_the_request"><span class="mw-headline-number">4.2</span> UI Action to initiate the request</span></h3>
<p>Before we build the UI Action, we should review some basic concepts of the MID Server and ECC Queue. By creating a record in the ECC Queue we can send a command to the MID Server. We need to define the following fields on an ECC Queue record. This is the part that could be used for any commands handled by the MID Server. 
</p>
<ul><li>Agent: what MID Server will run this comamnd </li>
<li>Topic: must be 'Command' to tell the MID server that this is a command </li>
<li>Name: the command to be executed </li>
<li>Queue: Must be 'output' so the MID Server knows it has work to do </li>
<li>State: Must be 'ready' so the MID Server knows it can do the work </li>
<li>Source: this field is optional and can be used for filtering or condition based filters, we will reference 'StarteamChange; INC#####'</li></ul>
<p>Now onto the UI Action. 
</p>
<table cellspacing="5" cellpadding="5" class="reproduce">

<tr>
<td scope="row" style="vertical-align:middle;"> <div class="floatleft"><a href="index.php%3Ftitle=File:Warning.gif.html" class="image" title="Note"><img alt="Note" src="images/thumb/c/c2/Warning.gif/16px-Warning.gif.png" width="16" height="16" srcset="/images/thumb/c/c2/Warning.gif/24px-Warning.gif.png 1.5x, /images/thumb/c/c2/Warning.gif/32px-Warning.gif.png 2x" /></a></div>
</td>
<td scope="row" style="vertical-align:top"> <b>Note:</b> <i>This API call changed in the Calgary release:</i>
<ul><li><i>GlideStringUtil</i> replaces <i>Packages.com.glide.util.StringUtil</i> </li></ul>
<p>The new script object calls apply to the Calgary release and beyond. For releases prior to Calgary, substitute the packages call as described above. Packages calls are not valid beginning with the Calgary release. For more information, see <a href="index.php%3Ftitle=Scripting_API_Changes.html" title="Scripting API Changes">Scripting API Changes</a>.
</p>
</td></tr></table>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// UI Action - Starteam Change</span>
<span class="c1">// Table: incident</span>
<span class="c1">// Form Context Menu</span>
<span class="c1">// Condition: current.u_starteam_change==&#39;&#39;</span>
<span class="c1">//</span>
<span class="c1">//To trigger a new change request in Borland Starteam</span>
<span class="c1">//This rule will submit an event to the ECC Queue and requires a MID Server</span>
<span class="c1">//to pickup the event and process the request</span>
<span class="c1">//</span>
<span class="c1">//The business rule Starteam - Process Response will populate the new Starteam</span>
<span class="c1">//change request number in the incident record</span>
<span class="c1">//</span>
<span class="c1">// 2008-04-01 ServiceNow Professional Services </span>
<span class="c1">//</span>

<span class="c1">// run it</span>
<span class="nx">createSTChange</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">createSTChange</span><span class="p">()</span> 
<span class="p">{</span>

 <span class="c1">//define MID Server to handle these requests</span>
 <span class="kd">var</span> <span class="nx">midServer</span> <span class="o">=</span> <span class="s1">&#39;midServerName_goes_here&#39;</span><span class="p">;</span>

 <span class="c1">//check to see if the assignment group has a ST project defined</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">assignment_group</span><span class="p">.</span><span class="nx">u_starteam_project</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">addErrorMessage</span><span class="p">(</span><span class="s1">&#39;The assignment group does not have a Starteam project.&#39;</span><span class="p">);</span>
 <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>
 
 <span class="c1">//create the command to run</span>
 <span class="c1">//you must provide the proper file name and path to the script residing on the MID Server</span>
 <span class="kd">var</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="s1">&#39;cscript c:\\scripts\\create_cr.js //NoLogo &#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /project:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">assignment_group</span><span class="p">.</span><span class="nx">u_starteam_project</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /synopsis:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">u_abstract</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /ext_ref:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_rn:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">caller_id</span><span class="p">.</span><span class="nx">getDisplayValue</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phpmp:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">caller_id</span><span class="p">.</span><span class="nx">phone</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phea:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">caller_id</span><span class="p">.</span><span class="nx">email</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phc:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">caller_id</span><span class="p">.</span><span class="nx">company</span><span class="p">.</span><span class="nx">getDisplayValue</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phd:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">caller_id</span><span class="p">.</span><span class="nx">department</span><span class="p">.</span><span class="nx">getDisplayValue</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phteam:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">u_original_assignment_group</span><span class="p">.</span><span class="nx">getDisplayValue</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phstxt:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">category</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phcattxt:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">subcategory</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /usr_phttxt:&quot;&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">u_topic</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>

 <span class="c1">//remove line feeds and carriage returns from the description</span>
 <span class="kd">var</span> <span class="nx">desc</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">u_original_comments</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
 <span class="nx">desc</span> <span class="o">=</span> <span class="nx">GlideStringUtil</span><span class="p">.</span><span class="nx">normalizeWhitespace</span><span class="p">(</span><span class="nx">desc</span><span class="p">);</span> 

 <span class="nx">cmd</span> <span class="o">+=</span> <span class="s1">&#39; /desc:&quot;&#39;</span> <span class="o">+</span> <span class="nx">desc</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>

 <span class="c1">//create a new ecc_queue record</span>
 <span class="kd">var</span> <span class="nx">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;ecc_queue&#39;</span><span class="p">);</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">initialize</span><span class="p">();</span>
 <span class="c1">//where to process</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">agent</span> <span class="o">=</span> <span class="s1">&#39;mid.server.&#39;</span> <span class="o">+</span> <span class="nx">midServer</span><span class="p">;</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">topic</span> <span class="o">=</span> <span class="s1">&#39;Command&#39;</span><span class="p">;</span>
 <span class="c1">//script to execute</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">cmd</span><span class="p">;</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">source</span> <span class="o">=</span> <span class="s1">&#39;StarteamChange:&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">number</span><span class="p">;</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">queue</span> <span class="o">=</span> <span class="s1">&#39;output&#39;</span><span class="p">;</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="s1">&#39;ready&#39;</span><span class="p">;</span>
 <span class="nx">queue</span><span class="p">.</span><span class="nx">insert</span><span class="p">();</span>

 <span class="c1">//Notify the user</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">addInfoMessage</span><span class="p">(</span><span class="s1">&#39;New change request has been queued. The new request number will be added to the incident once it is complete.&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h3><span class="mw-headline" id="Business_Rules_to_handle_response_from_Starteam"><span class="mw-headline-number">4.3</span> Business Rules to handle response from Starteam</span></h3>
<p>So now we've handed off control to the MID Server, which is going to execute the command we provided. Once the execution is completed, the stdOut and stdErr from the MID Server command will be sent back to the ECC Queue. Next we'll need a business rule to handle the incoming data. 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">// Business Rule - Starteam Process Response</span>
<span class="c1">// Table: ecc_queue</span>
<span class="c1">// When: before insert</span>
<span class="c1">// Condition: current.queue==&#39;input&#39; &amp;&amp; current.topic==&#39;Command&#39; &amp;&amp; current.source.toString().startsWith(&#39;StarteamChange&#39;) &amp;&amp; current.state==&#39;ready&#39;</span>
<span class="c1">//</span>
<span class="c1">//ECC Queue rule to process input responses from Starteam MID Server integration</span>
<span class="c1">//</span>
<span class="c1">//The UI Action, Starteam Change will generate the output queue record to</span>
<span class="c1">//be sent to the MID Server to create the Starteam change request.</span>
<span class="c1">//This rule will process the stdout from the creation script</span>
<span class="c1">//</span>
<span class="c1">// 2008-04-01 ServiceNow Professional Services </span>
<span class="c1">//</span>

<span class="c1">// run it</span>
<span class="nx">processSTResponse</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">processSTResponse</span><span class="p">()</span> 
<span class="p">{</span>

 <span class="c1">//get the response payload</span>
 <span class="kd">var</span> <span class="nx">stdout</span> <span class="o">=</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">getXMLText</span><span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">payload</span><span class="p">,</span> <span class="s1">&#39;//stdout&#39;</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">stderr</span> <span class="o">=</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">getXMLText</span><span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">payload</span><span class="p">,</span> <span class="s1">&#39;//stderr&#39;</span><span class="p">);</span>


 <span class="c1">//if there is an error notify and abort</span>
 <span class="c1">//this will trigger the starteam.error event which is linked to the Starteam Error email notification</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">stderr</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Starteam Process Response Error (&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">source</span> <span class="o">+</span> <span class="s1">&#39;): &#39;</span> <span class="o">+</span> <span class="nx">stderr</span> <span class="o">+</span> <span class="s1">&#39;\n&#39;</span> <span class="o">+</span> <span class="s1">&#39;See ECC Queue sequence &#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sequence</span> <span class="o">+</span> <span class="s1">&#39; for more detail.&#39;</span><span class="p">);</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">eventQueue</span><span class="p">(</span><span class="s1">&#39;starteam.error&#39;</span><span class="p">,</span><span class="nx">current</span><span class="p">,</span> <span class="nx">stdout</span><span class="p">,</span> <span class="nx">stderr</span><span class="p">);</span>
 <span class="c1">//update the queue record so it is not processed again</span>
 <span class="nx">current</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
 <span class="nx">current</span><span class="p">.</span><span class="nx">processed</span><span class="o">=</span><span class="nx">gs</span><span class="p">.</span><span class="nx">nowDateTime</span><span class="p">();</span>
 <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="c1">//set response search terms</span>
 <span class="kd">var</span> <span class="nx">crLabel</span> <span class="o">=</span> <span class="s1">&#39;ChangeRequest=&#39;</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">incLabel</span> <span class="o">=</span> <span class="s1">&#39;Incident=&#39;</span><span class="p">;</span>

 <span class="c1">//see if we created a change request</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">crLabel</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Starteam Process Response Error (&#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">source</span> <span class="o">+</span> <span class="s1">&#39;): Could not find the new change request number in the following response. \n&#39;</span> <span class="o">+</span> <span class="nx">stdout</span> <span class="o">+</span> <span class="s1">&#39;\n See ECC Queue sequence &#39;</span> <span class="o">+</span> <span class="nx">current</span><span class="p">.</span><span class="nx">sequence</span> <span class="o">+</span> <span class="s1">&#39; for more detail.&#39;</span><span class="p">);</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">eventQueue</span><span class="p">(</span><span class="s1">&#39;starteam.error&#39;</span><span class="p">,</span><span class="nx">current</span><span class="p">,</span> <span class="nx">stdout</span><span class="p">,</span> <span class="nx">stderr</span><span class="p">);</span>
 <span class="c1">//update the queue record so it is not processed again</span>
 <span class="nx">current</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
 <span class="nx">current</span><span class="p">.</span><span class="nx">processed</span><span class="o">=</span><span class="nx">gs</span><span class="p">.</span><span class="nx">nowDateTime</span><span class="p">();</span>
 <span class="k">return</span><span class="p">;</span>

 <span class="p">}</span>

 <span class="c1">//it&#39;s all good at this point, let&#39;s get on with it</span>

 <span class="c1">//find the change request number in the output</span>
 <span class="kd">var</span> <span class="nx">CRStart</span> <span class="o">=</span> <span class="nx">stdout</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">crLabel</span><span class="p">)</span><span class="o">+</span><span class="nx">crLabel</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">CREnd</span> <span class="o">=</span> <span class="nx">stdout</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">,</span><span class="nx">CRStart</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">crNumber</span> <span class="o">=</span> <span class="nx">stdout</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">CRStart</span><span class="p">,</span><span class="nx">CREnd</span><span class="p">);</span>

 <span class="c1">//find the incident number in the output</span>
 <span class="kd">var</span> <span class="nx">IncStart</span> <span class="o">=</span> <span class="nx">stdout</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">incLabel</span><span class="p">)</span><span class="o">+</span><span class="nx">incLabel</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">IncEnd</span> <span class="o">=</span> <span class="nx">stdout</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">,</span><span class="nx">IncStart</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">incNumber</span> <span class="o">=</span> <span class="nx">stdout</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">IncStart</span><span class="p">,</span><span class="nx">IncEnd</span><span class="p">);</span>

 <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Processing Starteam response&#39;</span><span class="p">);</span>

 <span class="c1">//get the related incident and add the Starteam number</span>
 <span class="kd">var</span> <span class="nx">inc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;incident&#39;</span><span class="p">);</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="nx">incNumber</span><span class="p">);</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">inc</span><span class="p">.</span><span class="nx">next</span><span class="p">())</span> <span class="p">{</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">u_starteam_change</span> <span class="o">=</span> <span class="nx">crNumber</span><span class="p">;</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Starteam change request &#39;</span> <span class="o">+</span> <span class="nx">crNumber</span> <span class="o">+</span> <span class="s1">&#39; was applied to Incident &#39;</span> <span class="o">+</span> <span class="nx">incNumber</span><span class="p">);</span>
 <span class="c1">//update the queue record so it is not processed again</span>
 <span class="nx">current</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="s1">&#39;processed&#39;</span><span class="p">;</span>
 <span class="nx">current</span><span class="p">.</span><span class="nx">processed</span><span class="o">=</span><span class="nx">gs</span><span class="p">.</span><span class="nx">nowDateTime</span><span class="p">();</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div> 
<h3><span class="mw-headline" id="Handling_Errors"><span class="mw-headline-number">4.4</span> Handling Errors</span></h3>
<p>As noted in the above business rule, if there are any unexpected results from Starteam command, we will fire a custom event to send a notification. 
</p>
<h3><span class="mw-headline" id="Inbound_Email_Action_to_handle_closure"><span class="mw-headline-number">4.5</span> Inbound Email Action to handle closure</span></h3>
This section will vary based on your Starteam configuration, but the concept would be to identify an email from the Starteam email address and capture the incident number from the subject and close the related incident. Here is the related section of the inbound rule. <div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">//handle Starteam notification</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">from</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;starteam@customer.com&#39;</span><span class="p">)</span> <span class="p">{</span>
 <span class="c1">//get the incident number from the subject</span>
 <span class="kd">var</span> <span class="nx">subject</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">subject</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">incidentNumber</span> <span class="o">=</span> <span class="nx">subject</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
 <span class="kd">var</span> <span class="nx">inc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s1">&#39;incident&#39;</span><span class="p">);</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="nx">incidentNumber</span><span class="p">);</span>
 <span class="c1">//set to closed and copy the body content to the close notes</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">incident_state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> 
 <span class="nx">inc</span><span class="p">.</span><span class="nx">close_notes</span> <span class="o">=</span> <span class="s1">&#39;Incident automatically closed since the related Starteam Change has been closed.\n&#39;</span> <span class="o">+</span> <span class="nx">email</span><span class="p">.</span><span class="nx">body_text</span><span class="p">;</span>
 <span class="nx">inc</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
 <span class="nx">gs</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Incident &#39;</span> <span class="o">+</span> <span class="nx">inc</span><span class="p">.</span><span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39; has been closed automatically since we received email notice from Starteam&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<!-- 
NewPP limit report
Cached time: 20171201081422
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.210 seconds
Real time usage: 1.926 seconds
Preprocessor visited node count: 96/1000000
Preprocessor generated node count: 341/1000000
Post‐expand include size: 3122/2097152 bytes
Template argument size: 1370/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%  471.867      1 - -total
  6.87%   32.406      1 - Template:Other_Integration
  4.21%   19.869      1 - Template:Topic
  2.11%    9.972      2 - Template:Note
  2.06%    9.707      1 - Template:Calgary_API_single
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:3934-0!*!0!1!en!5!* and timestamp 20171201081420 and revision id 196220
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html">http://wiki.servicenow.com/index.php?title=Borland_Starteam_Integration&amp;oldid=196220</a>"</div>
					<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>					<!-- end content -->
					<div id='mw-data-after-content'>
	<div id="rating_3934"><div class="voting-title">Was this article helpful?</div><div class="voting-box"><div class="vote-up " data-vote-id="3934" data-vote-the-vote="5" data-vote-id="3934" data-vote-action="5" data-vote-rating="5.00" data-vote-voted="0" id="rating_3934_5"><span>Yes, I found what I needed</span></div><div class="vote-down " data-vote-id="3934" data-vote-the-vote="1" data-vote-id="3934" data-vote-action="5" data-vote-rating="5.00" data-vote-voted="0" id="rating_3934_1"><span>No, I need more assistance</span></div></div></div>
</div>
					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
					<div id="p-cactions" class="portlet" role="navigation">
			<h5>Views</h5>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="index.php%3Ftitle=Borland_Starteam_Integration.html" title="View the content page [c]" accesskey="c">Page</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h5>Personal tools</h5>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="http://wiki.servicenow.com/index.php?title=Special:CreateAccount&amp;returnto=Borland+Starteam+Integration&amp;returntoquery=oldid%3D196220" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="http://wiki.servicenow.com/index.php?title=Special:UserLogin&amp;returnto=Borland+Starteam+Integration&amp;returntoquery=oldid%3D196220" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-" role="navigation">
		<h3></h3>
		<div class='pBody'>
			<div class="portlet">
<h5><span class="mw-headline" id="Categories">Categories</span></h5>
<div class="pBody">
<div class="sidebarcat">
<ul><li><a href="index.php%3Ftitle=Get_Started.html" title="Get Started">Get Started</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Use+ServiceNow&amp;oldid=0.html" title="Use ServiceNow">Use</a></li>
<li><a href="index.php%3Ftitle=Administer_ServiceNow.html" title="Administer ServiceNow">Administer</a></li>
<li><a href="index.php%3Ftitle=Script_in_ServiceNow.html" title="Script in ServiceNow">Script</a></li>
<li><a href="index.php%3Ftitle=Build.html" title="Build">Build</a></li>
<li><a href="index.php%3Ftitle=Deliver_ServiceNow.html" title="Deliver ServiceNow">Deliver</a></li>
<li><a href="index.php%3Ftitle=Integration_Overview.html" title="Integration Overview">Integrate</a></li>
<li><a href="index.php%3Ftitle=Release_Notes.html" title="Release Notes">Release Notes</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Customer+Support&amp;oldid=0.html" title="Customer Support">Customer Support</a></li>
<li><a href="index.php%3Ftitle=Books.html" title="Books">Books</a></li>
<li><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=remove_article&amp;arttitle=Video+Tutorials&amp;oldid=0.html" title="Video Tutorials">Video Tutorials</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="http://express.servicenow.com/support/">ServiceNow Express</a></li></ul>
</div>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Resources">Resources</span></h5>
<div class="pBody">
<ul><li><a href="index.php%3Ftitle=Category:Contents.html" title="Category:Contents">Site Map &#8211; Tree View</a><br /></li>
<li><a href="index.php%3Ftitle=Special:RecentChanges.html" title="Special:RecentChanges">Recent Changes</a><br /></li>
<li><a href="index.php%3Ftitle=Glossary_of_Terms.html" title="Glossary of Terms">Glossary</a><br /></li>
<li><a href="index.php%3Ftitle=Help:Getting_Started_on_the_ServiceNow_Wiki.html" title="Help:Getting Started on the ServiceNow Wiki">Wiki Help</a></li></ul>
</div>
</div>
<div class="portlet">
<h5><span class="mw-headline" id="Print">Print</span></h5>
<div class="pBody">
<ul><li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book&amp;bookcmd=book_creator.html">Create a Book</a></li>
<li><a href="index.php%3Ftitle=Help:Books.html" title="Help:Books">Book Help</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Special:Book%252Frender_article%252F&amp;arttitle=Borland_Starteam_Integration.html">Download Page as PDF</a></li>
<li><a target="_blank" rel="nofollow noreferrer noopener" class="external text" href="index.php%3Ftitle=Borland_Starteam_Integration&amp;printable=yes.html">Printable Version</a></li></ul>
</div>
</div>
		</div>
		</div>
		<div class="generated-sidebar portlet" id="p-coll-print_export" role="navigation">
		<h3>Print/export</h3>
		<div class='pBody'>
							<ul>
											<li id="coll-book_creator_disable"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=stop_book_creator&amp;referer=Borland+Starteam+Integration.html">Disable book creator</a></li>
											<li id="coll-download-as-rl"><a href="index.php%3Ftitle=Special:Book&amp;bookcmd=render_article&amp;arttitle=Borland+Starteam+Integration&amp;returnto=Borland+Starteam+Integration&amp;oldid=196220&amp;writer=rl.html">Download as PDF</a></li>
											<li id="t-print"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;printable=yes.html" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://wiki.servicenow.com/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search ServiceNow Wiki [f]" accesskey="f" id="searchInput"/>
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton"/>&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Toolbox</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="index.php%3Ftitle=Special:WhatLinksHere%252FBorland_Starteam_Integration.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here?</a></li>
											<li id="t-recentchangeslinked"><a href="http://wiki.servicenow.com/index.php?title=Special:RecentChangesLinked/Borland_Starteam_Integration" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="index.php%3Ftitle=Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-permalink"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;oldid=196220.html" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="index.php%3Ftitle=Borland_Starteam_Integration&amp;action=info.html" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified 21:22, 15 November 2013.</li>
									<li id="privacy"><a href="index.php%3Ftitle=ServiceNow_Wiki:Privacy_policy.html" title="ServiceNow Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="index.php%3Ftitle=ServiceNow_Wiki:About.html" title="ServiceNow Wiki:About">About ServiceNow Wiki</a></li>
									<li id="disclaimer"><a href="index.php%3Ftitle=ServiceNow_Wiki:General_disclaimer.html" title="ServiceNow Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["ext.treeandmenu","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.collection.bookcreator"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":906});});</script></body></html>
